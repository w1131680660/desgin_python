webpackJsonp([46],{OGkn:function(e,t){},hY56:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i("BO1k"),a=i.n(o),s=i("Gu7T"),r=i.n(s),l={name:"",props:{},data:function(){return{rightsData:[{num:1,name:"黄分院",accountNum:"AAS",department:"物流",accountType:"总监",accountState:"启用"}],allPermisPage:["权限页面1","权限页面2","权限页面3","权限页面4"],accountTypeAllo:{"总监":["权限页面1","权限页面1","权限页面1","权限页面1"],"主管":["权限页面1","权限页面1","权限页面1"],"专员A":["权限页面1","权限页面1"],"专员B":["权限页面1"]},roledata:{},editRightsDialog:{editRightsVisible:!1,editRightsForm:{checkedState:"",checkedName:"",checkedType:"",checkedName1:""},accountType:["总监","主管","专员A","专员B"],accountState:["启用","停用"]},editAccountDialog:{editAccountVisible:!1,editAccountForm:{checkedType:"",checkedRights:[]}},addAccountDialog:{addAccountVisible:!1,addAccountForm:{addAcountName:"",checkedRights:[]}},registerDialog:{registerVisible:!1,registerForm:{registerPhone:"",registerName:"",registerPassword:"",registerType:""},registerType:["总监","主管","专员A","专员B"]},formRoules:{checkedName:[{required:!0,message:"请输入姓名",trigger:"blur"}],checkedType:[{required:!0,message:"请选择账号类型",trigger:"blur"}],checkedState:[{required:!0,message:"请选择账号状态",trigger:"blur"}]},formRoules1:{registerName:[{required:!0,message:"请输入姓名",trigger:"blur"}],registerPhone:[{required:!0,message:"请输入电话",trigger:"blur"}],registerPassword:[{required:!0,message:"请输入密码",trigger:"blur"}],registerType:[{required:!0,message:"请选择账号状态",trigger:"blur"}]},passwordDialog:{passwordVisible:!1,passwordForm:{passwordPhone:""}},password_info:"",stationDialog:{stationVisible:!1,stationForm:{stationVal:[]}},station:["黄金糕"],station_account:""}},computed:{},watch:{},created:function(){var e=this;this.$axios({url:this._url2+"server/stock_management/is_open/",method:"get"}).then(function(t){200==t.data.code?e.GetUserList():(alert("您没有权限进入这个页面"),e.$router.push("/Login"))})},methods:{GetUserList:function(){console.log(1231,"进来发请求");var e=this;this.$axios({url:e._url2+"server/personnel_management/authority_management/",methods:"get"}).then(function(t){console.log(233,t.data.code),200===t.data.code?(console.log("这是全部数据",t.data),e.rightsData=t.data.user_data,e.rightsData.map(function(e,t){"all"==e.area&&(e.area="全部")}),console.log("这是角色数据role_data",t.data.role_data),console.log("这是用户的数据",t.data.user_data),console.log("这是权限数据",t.data.permission_data),e.accountTypeAllo=t.data.role_data,e.allPermisPage=t.data.permission_data):alert(t.data)})},save_edit:function(){var e=this,t=this.editRightsDialog.editRightsForm.checkedName,i=this.editRightsDialog.editRightsForm.checkedType,o=this.editRightsDialog.editRightsForm.checkedState,a=this.editRightsDialog.editRightsForm.checkedName1;o="启用"==o?"1":"0";var s=new FormData;s.append("account",a),s.append("state",o),s.append("roles",i),s.append("real_name",t),this.$axios.post(e._url2+"server/personnel_management/authority_management/",s).then(function(t){console.log(233,t.data),200===t.data.code?(console.log(t.data),e.rightsData=t.data.user_data,e.editRightsDialog.editRightsVisible=!1):alert(t.data)})},editRights:function(e,t){this.editRightsDialog.editRightsForm.checkedName=e,this.editRightsDialog.editRightsForm.checkedName1=t,this.editRightsDialog.editRightsVisible=!0},editAccountRights:function(){this.editAccountDialog.editAccountVisible=!0},addAccountRights:function(){this.addAccountDialog.addAccountVisible=!0},accountTypeChange:function(e){var t=this;this.editAccountDialog.editAccountForm.checkedRights=[],console.log(e),this.accountTypeAllo.forEach(function(i){var o;i.role_name==e&&(o=t.editAccountDialog.editAccountForm.checkedRights).push.apply(o,r()(i.title))})},editRightsDialogClose:function(){this.$refs.editRightsRef.resetFields(),console.log()},editAccountDialogClose:function(){this.$refs.editAccountRef.resetFields()},addAccountDialogClose:function(){this.$refs.addAccountRef.resetFields()},registerDialogClose:function(){this.$refs.registerRef.resetFields()},passwordDialogClose:function(){this.$refs.passwordRef.resetFields()},stationDialogClose:function(){this.$refs.stationRef.resetFields()},editAccountType:function(){var e=this.editAccountDialog.editAccountForm.checkedType,t=[],i=!0,o=!1,s=void 0;try{for(var r,l=a()(this.editAccountDialog.editAccountForm.checkedRights);!(i=(r=l.next()).done);i=!0){var n=r.value,c=!0,d=!1,g=void 0;try{for(var u,h=a()(this.allPermisPage);!(c=(u=h.next()).done);c=!0){var m=u.value;m.title==n&&t.push(m.id)}}catch(e){d=!0,g=e}finally{try{!c&&h.return&&h.return()}finally{if(d)throw g}}}}catch(e){o=!0,s=e}finally{try{!i&&l.return&&l.return()}finally{if(o)throw s}}var p=new FormData;p.append(" permission_id_list",t),p.append("role_name",e),this.$axios.post(that._url2+"server/personnel_management/authority_management/",p).then(function(e){console.log(233,e.data),200===e.data.code?(console.log(e.data),that.rightsData=e.data.user_data,that.editRightsDialog.editRightsVisible=!1):alert(e.data)})},register:function(){var e=this;this.registerDialog.registerVisible=!0,this.$axios({url:e._url2+"server/personnel_management/get_all_rolas/",methods:"get"}).then(function(t){"200"===t.data.code?(console.log(t.data),e.registerDialog.registerType=t.data.data):alert(t.data)})},register_sure:function(){var e=this,t=this;this.$refs.registerRef.validate(function(i){if(!i)return!1;var o=new FormData;o.append("name",e.registerDialog.registerForm.registerName),o.append("tel",e.registerDialog.registerForm.registerPhone),o.append("password",e.registerDialog.registerForm.registerPassword),o.append("roles",e.registerDialog.registerForm.registerType),e.$axios.post(t._url2+"server/personnel_management/add_user/",o).then(function(e){"200"===e.data.code?(t.$message.success("注册成功"),t.registerDialog.registerVisible=!1,window.location.reload()):t.$message.error(e.data.msg)})})},delRights:function(e){var t=this;console.log(e);var i=new FormData;i.append("account",e),this.$axios.post(t._url2+"server/personnel_management/delete_user/",i).then(function(e){200===e.data.code?(alert("删除成功"),window.location.reload()):t.$message.error("删除失败")})},delPassword:function(e){this.passwordDialog.passwordVisible=!0,this.password_info=e},password_sure:function(){var e=this,t=this.password_info,i=this.passwordDialog.passwordForm.password,o=new FormData;o.append("account",t),o.append("password",i),this.$axios.post(e._url2+"server/personnel_management/update_pswd/",o).then(function(t){200===t.data.code?e.$message.success("修改成功"):e.$message.error("修改失败")})},station_sign:function(e){this.stationDialog.stationVisible=!0,this.station_account=e;var t=this;this.$axios.get(t._url2+"server/personnel_management/area_sign_data/",{params:{account:e}}).then(function(e){200===e.data.code&&(console.log(e.data),t.stationDialog.stationForm.stationVal=e.data.data1,t.station=e.data.data)})},station_sure:function(){var e=this,t=this.station_account,i=this.station;console.log(t,i);var o=new FormData;o.append("account",t),o.append("area",i),this.$axios.post(e._url2+"server/personnel_management/area_sign/",o).then(function(t){200===t.data.code?(alert(t.data.msg),window.location.reload()):e.$message.error("修改站点分配失败")})}}},n={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"rightManage"},[i("el-button",{staticClass:"register",attrs:{type:"success"},on:{click:e.register}},[e._v("注册")]),e._v(" "),i("div",{staticClass:"table"},[i("table",[i("h2",[e._v("人员权限分配")]),e._v(" "),e._m(0),e._v(" "),i("tbody",e._l(e.rightsData,function(t,o){return i("tr",{key:o},[i("td",[e._v(e._s(o+1))]),e._v(" "),i("td",[e._v(e._s(t.real_name))]),e._v(" "),i("td",[e._v(e._s(t.account))]),e._v(" "),i("td",[e._v(e._s(t.department))]),e._v(" "),i("td",[e._v(e._s(t.area))]),e._v(" "),i("td",[e._v(e._s(t.roles))]),e._v(" "),1==t.state?i("td",[e._v("启用")]):i("td",[e._v("停用")]),e._v(" "),i("td",{staticStyle:{width:"20vw"}},[i("div",{staticStyle:{}},[i("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(i){return e.editRights(t.real_name,t.account)}}},[e._v("编辑")]),e._v(" "),i("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(i){return e.delRights(t.account)}}},[e._v("删除")]),e._v(" "),i("el-button",{attrs:{type:"info",size:"mini"},on:{click:function(i){return e.delPassword(t.account)}}},[e._v("修改密码")]),e._v(" "),i("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(i){return e.station_sign(t.account)}}},[e._v("站点标记")])],1)])])}),0)])]),e._v(" "),i("div",{staticClass:"table"},[i("table",[i("h2",[e._v("账号类型权限分配")]),e._v(" "),i("thead",[i("tr",[i("th",[e._v("账号类型")]),e._v(" "),e._l(e.accountTypeAllo,function(t,o){return i("th",{key:o},[e._v("\n            "+e._s(t.role_name)+"\n          ")])})],2)]),e._v(" "),i("tbody",[i("tr",[i("td",[e._v("账号权限")]),e._v(" "),e._l(e.accountTypeAllo,function(t,o){return i("td",{key:o},e._l(t.title,function(t){return i("p",{key:t},[e._v("\n              "+e._s(t)+"\n            ")])}),0)})],2)])]),e._v(" "),i("div",{staticStyle:{"margin-top":"10px"}},[i("el-button",{attrs:{type:"warning",size:"mini"},on:{click:e.editAccountRights}},[e._v("编辑")]),e._v(" "),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.addAccountRights}},[e._v("新增")])],1)]),e._v(" "),i("el-dialog",{attrs:{title:"权限分配",visible:e.editRightsDialog.editRightsVisible,width:"30%",center:""},on:{"update:visible":function(t){return e.$set(e.editRightsDialog,"editRightsVisible",t)},close:e.editRightsDialogClose}},[i("el-form",{ref:"editRightsRef",attrs:{model:e.editRightsDialog.editRightsForm,"label-width":"80px",rules:e.formRoules}},[i("el-form-item",{attrs:{label:"姓名",prop:"checkedName"}},[i("el-input",{model:{value:e.editRightsDialog.editRightsForm.checkedName,callback:function(t){e.$set(e.editRightsDialog.editRightsForm,"checkedName",t)},expression:"editRightsDialog.editRightsForm.checkedName"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"账号类型",prop:"checkedType"}},[i("el-select",{attrs:{placeholder:"请选择"},model:{value:e.editRightsDialog.editRightsForm.checkedType,callback:function(t){e.$set(e.editRightsDialog.editRightsForm,"checkedType",t)},expression:"editRightsDialog.editRightsForm.checkedType"}},e._l(e.accountTypeAllo,function(e){return i("el-option",{key:e.role_name,attrs:{label:e.role_name,value:e.role_name}})}),1)],1),e._v(" "),i("el-form-item",{attrs:{label:"账号状态",prop:"checkedState"}},[i("el-select",{attrs:{placeholder:"请选择"},model:{value:e.editRightsDialog.editRightsForm.checkedState,callback:function(t){e.$set(e.editRightsDialog.editRightsForm,"checkedState",t)},expression:"editRightsDialog.editRightsForm.checkedState"}},e._l(e.editRightsDialog.accountState,function(e){return i("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1)],1),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.editRightsDialog.editRightsVisible=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.save_edit()}}},[e._v("保 存")])],1)],1),e._v(" "),i("el-dialog",{attrs:{title:"编辑账号类型权限",visible:e.editAccountDialog.editAccountVisible,width:"30%",center:""},on:{"update:visible":function(t){return e.$set(e.editAccountDialog,"editAccountVisible",t)},close:e.editAccountDialogClose}},[i("el-form",{ref:"editAccountRef",attrs:{model:e.editAccountDialog.editAccountForm,"label-width":"80px",rules:e.formRoules}},[i("el-form-item",{attrs:{label:"账号类型",prop:"checkedType"}},[i("el-select",{attrs:{placeholder:"请选择"},on:{change:e.accountTypeChange},model:{value:e.editAccountDialog.editAccountForm.checkedType,callback:function(t){e.$set(e.editAccountDialog.editAccountForm,"checkedType",t)},expression:"editAccountDialog.editAccountForm.checkedType"}},e._l(e.accountTypeAllo,function(e){return i("el-option",{key:e.role_name,attrs:{label:e.role_name,value:e.role_name}})}),1)],1),e._v(" "),i("el-form-item",{attrs:{label:"权限更改"}},[i("el-checkbox-group",{model:{value:e.editAccountDialog.editAccountForm.checkedRights,callback:function(t){e.$set(e.editAccountDialog.editAccountForm,"checkedRights",t)},expression:"editAccountDialog.editAccountForm.checkedRights"}},e._l(e.allPermisPage,function(e){return i("el-checkbox",{key:e.id,attrs:{label:e.title}})}),1)],1)],1),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.editAccountDialog.editAccountVisible=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.editAccountType}},[e._v("确 定")])],1)],1),e._v(" "),i("el-dialog",{attrs:{title:"新增权限分配",visible:e.addAccountDialog.addAccountVisible,width:"30%",center:""},on:{"update:visible":function(t){return e.$set(e.addAccountDialog,"addAccountVisible",t)},close:e.addAccountDialogClose}},[i("el-form",{ref:"addAccountRef",attrs:{model:e.addAccountDialog.addAccountForm,"label-width":"80px",rules:e.formRoules}},[i("el-form-item",{attrs:{label:"账号类型",prop:"accountType"}},[i("el-input",{model:{value:e.addAccountDialog.addAccountForm.addAcountName,callback:function(t){e.$set(e.addAccountDialog.addAccountForm,"addAcountName",t)},expression:"addAccountDialog.addAccountForm.addAcountName"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"权限选择"}},[i("el-checkbox-group",{model:{value:e.addAccountDialog.addAccountForm.checkedRights,callback:function(t){e.$set(e.addAccountDialog.addAccountForm,"checkedRights",t)},expression:"addAccountDialog.addAccountForm.checkedRights"}},e._l(e.allPermisPage,function(e){return i("el-checkbox",{key:e.id,attrs:{label:e.title}})}),1)],1)],1),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.addAccountDialog.addAccountVisible=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addAccountDialog.addAccountVisible=!1}}},[e._v("确 定")])],1)],1),e._v(" "),i("el-dialog",{attrs:{title:"注册",visible:e.registerDialog.registerVisible,width:"30%",center:""},on:{"update:visible":function(t){return e.$set(e.registerDialog,"registerVisible",t)},close:e.registerDialogClose}},[i("el-form",{ref:"registerRef",attrs:{model:e.registerDialog.registerForm,"label-width":"80px",rules:e.formRoules1}},[i("el-form-item",{attrs:{label:"姓名",prop:"registerName"}},[i("el-input",{model:{value:e.registerDialog.registerForm.registerName,callback:function(t){e.$set(e.registerDialog.registerForm,"registerName",t)},expression:"registerDialog.registerForm.registerName"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"电话",prop:"registerPhone"}},[i("el-input",{model:{value:e.registerDialog.registerForm.registerPhone,callback:function(t){e.$set(e.registerDialog.registerForm,"registerPhone",t)},expression:"registerDialog.registerForm.registerPhone"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"密码",prop:"registerPassword"}},[i("el-input",{model:{value:e.registerDialog.registerForm.registerPassword,callback:function(t){e.$set(e.registerDialog.registerForm,"registerPassword",t)},expression:"registerDialog.registerForm.registerPassword"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"账号类型",prop:"registerType"}},[i("el-select",{attrs:{placeholder:"请选择"},model:{value:e.registerDialog.registerForm.registerType,callback:function(t){e.$set(e.registerDialog.registerForm,"registerType",t)},expression:"registerDialog.registerForm.registerType"}},e._l(e.registerDialog.registerType,function(e,t){return i("el-option",{key:t,attrs:{label:e.roles,value:e.roles}})}),1)],1)],1),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.registerDialog.registerVisible=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.register_sure()}}},[e._v("注 册")])],1)],1),e._v(" "),i("el-dialog",{attrs:{title:"修改密码",visible:e.passwordDialog.passwordVisible,width:"30%",center:""},on:{"update:visible":function(t){return e.$set(e.passwordDialog,"passwordVisible",t)},close:e.passwordDialogClose}},[i("el-form",{ref:"passwordRef",attrs:{model:e.passwordDialog.passwordForm,"label-width":"80px"}},[i("el-form-item",{attrs:{label:"新密码",prop:"password"}},[i("el-input",{model:{value:e.passwordDialog.passwordForm.password,callback:function(t){e.$set(e.passwordDialog.passwordForm,"password",t)},expression:"passwordDialog.passwordForm.password"}})],1)],1),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.passwordDialog.passwordVisible=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.password_sure()}}},[e._v("确定")])],1)],1),e._v(" "),i("el-dialog",{attrs:{title:"站点标记",visible:e.stationDialog.stationVisible,width:"30%",center:""},on:{"update:visible":function(t){return e.$set(e.stationDialog,"stationVisible",t)},close:e.stationDialogClose}},[i("el-form",{ref:"stationRef",attrs:{model:e.stationDialog.stationForm,"label-width":"80px"}},[i("el-select",{staticStyle:{"margin-left":"20px"},attrs:{multiple:"","collapse-tags":"",placeholder:"请选择"},model:{value:e.station,callback:function(t){e.station=t},expression:"station"}},e._l(e.stationDialog.stationForm.stationVal,function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.stationDialog.stationVisible=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.station_sure()}}},[e._v("确定")])],1)],1)],1)},staticRenderFns:[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("thead",[i("tr",[i("th",[e._v("序号")]),e._v(" "),i("th",[e._v("姓名")]),e._v(" "),i("th",[e._v("账号")]),e._v(" "),i("th",[e._v("部门")]),e._v(" "),i("th",[e._v("站点分配")]),e._v(" "),i("th",[e._v("账号类型")]),e._v(" "),i("th",[e._v("账号状态")]),e._v(" "),i("th",{staticStyle:{width:"20vw"}},[e._v("操作")])])])}]};var c=i("VU/8")(l,n,!1,function(e){i("rKCW"),i("OGkn")},"data-v-28c7edd5",null);t.default=c.exports},rKCW:function(e,t){}});
//# sourceMappingURL=46.f5a402da74d1447ceec1.js.map