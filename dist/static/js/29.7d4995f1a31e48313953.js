webpackJsonp([29],{KDDh:function(t,e){},iH7y:function(t,e){},nQFu:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("fZjL"),s=i.n(a),o={data:function(){return{sys_names:[],bugForm:{description:"",suggest:"",imglist:[]},bugDetail:!1,searchVal:"",returnItem:"",turnDownFlag:!1,sys_name:"运营系统",bugList:[],page_names:[],selectID:[],addFormData:"",addDialogVisible:!1,addForm:{project_name:"",page_name:"",description:"",expect_time:"",initiator:"",suggest:"",need_type:""},editDialogVisible:!1,editFormData:"",bugList2:[],editForm:{project_name:"",page_name:"xxx",description:"",suggest:"",expect_time:""},editId:"",bugTable:[],turndown_reason:"",allPageList:{},username:"",editImgList:[]}},methods:{formatTime:function(){var t=new Date;return t.getFullYear()+"-"+(t.getMonth()+1>10?t.getMonth()+1:"0"+(t.getMonth()+1))+"-"+(t.getDate()+1>10?t.getDate()+1:"0"+(t.getDate()+1))},changePage:function(){for(var t in console.log("切换页面"),this.page_names=[],this.addForm.page_name="",this.allPageList)t===this.addForm.project_name&&(this.page_names=this.allPageList[t])},showBugDetail:function(t){console.log(t),console.log(111),this.bugForm.description=t.description,this.bugForm.suggest=t.suggest;var e=t.pic_url.split("@");for(var i in e)e[i]="https://www.beyoung.group/static/"+e[i];this.bugForm.imglist=e,this.bugDetail=!0},reDemand:function(){this.reEditRow(this.returnItem.id),this.turnDownFlag=!1},closeBugDetail:function(){this.bugDetail=!1},showTurnDown:function(t){this.returnItem=t,this.turnDownFlag=!0},search:function(){this.getBugTable()},closeTurnDown:function(){this.turnDownFlag=!1},showBigImg:function(t){this.showBigImgFlag=!0},checkImgType:function(t){return/\w(\.gif|\.jpeg|\.png|\.jpg|\.bmp)$/i.test(t)},beforeUploadBug:function(t,e){var i=t.raw;if(!this.checkImgType(i.name))return this.bugList=[],void this.$message.warning("请上传图片类型文件");this.bugList=[],this.bugList.push(t)},handleRemoveBug:function(t,e){this.bugList=e,console.log(t,e)},submitAddForm:function(){var t=this;if(this.bugList.length>1)alert("只能上传一个图片文件！");else{for(var e in this.addFormData=new FormData,this.addForm){if(console.log(this.addForm[e],e),"need_type"!==e&&""===this.addForm[e])return void alert("除了图片文件外其他字段必须填写！");this.addFormData.append(e,this.addForm[e])}var i=this.formatTime();for(var a in this.addFormData.append("initiate_time",i),console.log(this.bugList),this.bugList)this.addFormData.append("pic_url",this.bugList[a].raw);this.addDialogVisible=!1;var s=this._url2+"server/personnel_management/bug_feedback/";this.$axios.post(s,this.addFormData).then(function(e){if(console.log(e),200==e.data.code){for(var i in alert("新增成功！"),t.getBugTable(),t.addForm)"initiator"!==i&&(t.addForm[i]="");t.file="",t.bugList=[]}})}},cancelAddForm:function(){for(var t in this.addForm)"initiator"!==t&&(this.addForm[t]="");this.addDialogVisible=!1,this.bugList=[]},beforeUploadBugEdit:function(t,e){var i=t.raw;if(!this.checkImgType(i.name))return this.bugList2=[],void this.$message.warning("请上传图片类型文件");this.bugList2=[],this.bugList2.push(t)},handleRemoveBugEdit:function(t,e){this.bugList2=e},submitEditForm:function(){var t=this;if(this.editFormData=new FormData,this.bugList2.length>1)alert("只能上传一个图片文件！");else{for(var e in this.editForm){if(!this.editForm[e])return void alert("所有字段必填！");"description"!==e&&"suggest"!==e||(console.log(e),this.editFormData.append(e,this.editForm[e]))}for(var i in this.editDialogVisible=!1,this.bugList2)this.editFormData.append("pic_url",this.bugList2[i].raw);this.editFormData.append("id",this.editId);var a=this._url2+"server/personnel_management/bug_feedback/";this.$axios.put(a,this.editFormData).then(function(e){200==e.data.code?(alert("修改成功"),t.getBugTable(),t.bugList2=[],t.editId=""):alert("修改未成功！")})}},cancelEditForm:function(){this.bugList2=[],this.editDialogVisible=!1},addBug:function(){this.addDialogVisible=!0},editBug:function(){this.selectID=[];var t=this;if($(".tablebox input:checked").each(function(){console.log($(this)),console.log("选中了",$(this).val()),t.selectID.push($(this).val())}),$(".tablebox input:checked").length)if($(".tablebox input:checked").length>1)alert("请选择一个进行编辑！");else{console.log(this.selectID);var e=this.selectID[0];console.log(e);var i=this.bugTable.find(function(t){return t.id==e});"已提起"===i.data_status?(console.log(i),this.editForm.project_name=i.project_name,this.editForm.page_name=i.page_name,this.editForm.description=i.description,this.editForm.suggest=i.suggest,this.editId=e,this.editForm.expect_time=i.expect_time,this.editDialogVisible=!0,i.pic_url&&(this.editImgList=i.pic_url.split("@"))):alert("只能编辑待审核状态的数据！")}else alert("请选择一个进行编辑！")},reEditRow:function(t){this.addBug();var e=this.bugTable.find(function(e){return e.id==t});for(var i in console.log(e),this.addForm)this.addForm[i]=e[i]},deleteBug:function(){var t=this;this.selectID=[];var e=this;($(".tablebox input:checked").each(function(){console.log("选中了",$(this).val()),e.selectID.push($(this).val())}),!$(".tablebox input:checked").length||$(".tablebox input:checked").length>1)?alert("请选择一个进行删除！"):"已提起"===this.bugTable.find(function(e){return e.id==t.selectID[0]}).data_status?(console.log(this.selectID),this.$confirm("此操作将永久删除该数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var e=t._url2+"server/personnel_management/bug_feedback/";t.$axios.delete(e,{params:{id:t.selectID[0]}}).then(function(e){console.log(e),200===e.data.code&&(t.$message("删除成功！"),t.getBugTable())})}).catch(function(t){console.log(t)})):alert("只能删除待审核状态的数据！")},getBugTable:function(){var t=this,e=this._url2+"server/personnel_management/bug_feedback/";this.$axios.get(e,{params:{condition:this.searchVal}}).then(function(e){console.log(e),200==e.data.code?(t.allPageList=e.data.down_data,t.sys_names=s()(t.allPageList)||[],t.bugTable=e.data.re_data||[]):alert("获取数据失败")})}},created:function(){this.getBugTable(),this.username=sessionStorage.getItem("user_name")||"",this.addForm.initiator=this.username}},n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"bug_release"}},[i("div",{staticClass:"topOpt"},[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.addBug}},[t._v("新增")]),t._v(" "),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.editBug}},[t._v("编辑")]),t._v(" "),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.deleteBug}},[t._v("删除")]),t._v(" "),i("el-input",{staticStyle:{width:"200px"},attrs:{size:"mini",placeholder:"请输入任意字段搜索"},on:{change:t.search},model:{value:t.searchVal,callback:function(e){t.searchVal=e},expression:"searchVal"}})],1),t._v(" "),i("div",{staticClass:"tablebox"},[i("table",[t._m(0),t._v(" "),i("tbody",t._l(t.bugTable,function(e,a){return i("tr",{key:a},[i("td",[i("div",[i("input",{attrs:{type:"checkbox"},domProps:{value:e.id}})])]),t._v(" "),i("td",[i("div",[t._v(t._s(a+1))])]),t._v(" "),i("td",[t._v("\n            "+t._s(e.initiator)+"\n          ")]),t._v(" "),i("td",[i("div",[t._v(t._s(e.project_name))])]),t._v(" "),i("td",[i("div",[t._v(t._s(e.page_name))])]),t._v(" "),i("td",[i("div",{staticClass:"detailMsg",on:{click:function(i){return t.showBugDetail(e)}}},[t._v("\n              "+t._s(e.description)+"\n            ")])]),t._v(" "),i("td",[i("div",[t._v("\n              "+t._s(e.expect_time)+"\n            ")])]),t._v(" "),i("td",[i("div",[t._v(t._s(e.it_time))])]),t._v(" "),i("td",["已驳回"!==e.data_status?i("div",[t._v("\n              "+t._s(e.data_status)+"\n            ")]):i("div",{on:{click:function(i){return t.showTurnDown(e)}}},[t._v("\n              "+t._s(e.data_status)+"\n            ")])])])}),0)]),t._v(" "),i("el-dialog",{attrs:{title:"新增系统反馈",visible:t.addDialogVisible,width:"80%","before-close":t.cancelAddForm},on:{"update:visible":function(e){t.addDialogVisible=e}}},[i("div",{staticClass:"addForm"},[i("div",{staticClass:"form_item"},[i("p",[t._v("项目名称")]),t._v(" "),i("el-select",{on:{change:t.changePage},model:{value:t.addForm.project_name,callback:function(e){t.$set(t.addForm,"project_name",e)},expression:"addForm.project_name"}},t._l(t.sys_names,function(e,a){return i("el-option",{key:a,attrs:{label:e,value:e}},[t._v(t._s(e))])}),1)],1),t._v(" "),i("div",{staticClass:"form_item"},[i("p",[t._v("页面名称")]),t._v(" "),i("el-select",{model:{value:t.addForm.page_name,callback:function(e){t.$set(t.addForm,"page_name",e)},expression:"addForm.page_name"}},t._l(t.page_names,function(e,a){return i("el-option",{key:a,attrs:{label:e,value:e}},[t._v(t._s(e))])}),1)],1),t._v(" "),i("div",{staticClass:"form_item"},[i("p",[t._v("提报人")]),t._v(" "),i("el-input",{attrs:{readonly:"",placeholder:"请输入提报人"},model:{value:t.addForm.initiator,callback:function(e){t.$set(t.addForm,"initiator",e)},expression:"addForm.initiator"}})],1),t._v(" "),i("div",{staticClass:"form_item totalBlock"},[i("p",[t._v("系统问题")]),t._v(" "),i("el-input",{attrs:{type:"textarea",rows:8,placeholder:"请输入系统问题"},model:{value:t.addForm.description,callback:function(e){t.$set(t.addForm,"description",e)},expression:"addForm.description"}})],1),t._v(" "),i("div",{staticClass:"form_item totalBlock"},[i("p",[t._v("优化建议")]),t._v(" "),i("el-input",{attrs:{type:"textarea",rows:8,placeholder:"请输入优化建议"},model:{value:t.addForm.suggest,callback:function(e){t.$set(t.addForm,"suggest",e)},expression:"addForm.suggest"}})],1),t._v(" "),i("div",{staticClass:"form_item"},[i("p",[t._v("Bug图片上传")]),t._v(" "),i("el-upload",{ref:"uploadBug",staticClass:"upload-demo",attrs:{drag:"",action:"123",multiple:"","file-list":t.bugList,"on-change":t.beforeUploadBug,"on-remove":t.handleRemoveBug,"auto-upload":!1,accept:"image/*"}},[i("i",{staticClass:"el-icon-upload"}),t._v(" "),i("div",{staticClass:"el-upload__text"},[t._v("\n              将文件拖到此处，或\n              "),i("em",[t._v("点击上传")])])])],1),t._v(" "),i("div",{staticClass:"form_item"},[i("p",[t._v("预期完成时间")]),t._v(" "),i("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},model:{value:t.addForm.expect_time,callback:function(e){t.$set(t.addForm,"expect_time",e)},expression:"addForm.expect_time"}})],1),t._v(" "),i("br"),t._v(" "),i("div",{staticClass:"form_item"},[i("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary"},on:{click:t.submitAddForm}},[t._v("提交")]),t._v(" "),i("el-button",{attrs:{type:"info"},on:{click:t.cancelAddForm}},[t._v("取消")])],1)])]),t._v(" "),i("el-dialog",{attrs:{title:"系统反馈修改",visible:t.editDialogVisible,width:"80%","before-close":t.cancelEditForm},on:{"update:visible":function(e){t.editDialogVisible=e}}},[i("div",{staticClass:"editForm"},[i("div",{staticClass:"form_item"},[i("p",[t._v("项目名称")]),t._v(" "),i("el-input",{attrs:{readonly:""},model:{value:t.editForm.project_name,callback:function(e){t.$set(t.editForm,"project_name",e)},expression:"editForm.project_name"}})],1),t._v(" "),i("div",{staticClass:"form_item"},[i("p",[t._v("页面名称")]),t._v(" "),i("el-input",{attrs:{readonly:""},model:{value:t.editForm.page_name,callback:function(e){t.$set(t.editForm,"page_name",e)},expression:"editForm.page_name"}})],1),t._v(" "),i("div",{staticClass:"form_item totalBlock1"},[i("p",[t._v("系统问题")]),t._v(" "),i("el-input",{attrs:{type:"textarea",rows:7,placeholder:"请输入bug描述"},model:{value:t.editForm.description,callback:function(e){t.$set(t.editForm,"description",e)},expression:"editForm.description"}})],1),t._v(" "),i("div",{staticClass:"form_item totalBlock1"},[i("p",[t._v("优化建议")]),t._v(" "),i("el-input",{attrs:{type:"textarea",rows:7,placeholder:"请输入bug描述"},model:{value:t.editForm.suggest,callback:function(e){t.$set(t.editForm,"suggest",e)},expression:"editForm.suggest"}})],1),t._v(" "),t.editImgList.length>0?i("div",{staticClass:"form_item",staticStyle:{width:"100%"}},[i("p",[t._v("图片列表")]),t._v(" "),i("div",{staticClass:"imgList"},t._l(t.editImgList,function(e,a){return i("a",{key:a,attrs:{target:"_blank",href:"https://www.beyoung.group/static/"+e}},[t._v("查看原图")])}),0)]):t._e(),t._v(" "),i("div",{staticClass:"form_item"},[i("p",[t._v("Bug图片上传")]),t._v(" "),i("el-upload",{ref:"uploadBug",staticClass:"upload-demo",attrs:{drag:"",multiple:"",action:"123","file-list":t.bugList2,"on-change":t.beforeUploadBugEdit,"on-remove":t.handleRemoveBugEdit,"auto-upload":!1,accept:"image/*"}},[i("i",{staticClass:"el-icon-upload"}),t._v(" "),i("div",{staticClass:"el-upload__text"},[t._v("\n              将文件拖到此处，或\n              "),i("em",[t._v("点击上传")])])])],1),t._v(" "),i("div",{staticClass:"form_item"},[i("p",[t._v("预期完成时间")]),t._v(" "),i("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",readonly:"",type:"date",placeholder:"选择日期"},model:{value:t.editForm.expect_time,callback:function(e){t.$set(t.editForm,"expect_time",e)},expression:"editForm.expect_time"}})],1),t._v(" "),i("div",{staticClass:"form_item",staticStyle:{width:"100%","text-align":"center",margin:"0 auto"}},[i("div",{staticClass:"btn"},[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.submitEditForm}},[t._v("提交")]),t._v(" "),i("el-button",{attrs:{type:"info",size:"mini"},on:{click:t.cancelEditForm}},[t._v("取消")])],1)])])]),t._v(" "),i("el-dialog",{attrs:{title:"驳回详情",visible:t.turnDownFlag,width:"400px","before-close":t.closeTurnDown},on:{"update:visible":function(e){t.turnDownFlag=e}}},[i("div",[i("p",[i("span",[t._v("产品经理驳回：")]),t._v("\n          "+t._s(t.returnItem.cp_note)+"\n        ")]),t._v(" "),i("p",[i("span",[t._v("IT中间驳回：")]),t._v("\n          "+t._s(t.returnItem.zj_note)+"\n        ")]),t._v(" "),i("div",[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.reDemand}},[t._v("重新编辑")])],1)])]),t._v(" "),i("div",{staticClass:"des"},[i("el-dialog",{attrs:{title:"系统问题描述",visible:t.bugDetail,width:"400px","before-close":t.closeBugDetail,modal:!1},on:{"update:visible":function(e){t.bugDetail=e}}},[i("el-form",{staticClass:"detailDialog",attrs:{model:t.bugForm}},[i("el-form-item",{attrs:{label:"系统问题"}},[i("el-input",{attrs:{readonly:"",type:"textarea",rows:3},model:{value:t.bugForm.description,callback:function(e){t.$set(t.bugForm,"description",e)},expression:"bugForm.description"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"优化建议"}},[i("el-input",{attrs:{readonly:"",type:"textarea",rows:3},model:{value:t.bugForm.suggest,callback:function(e){t.$set(t.bugForm,"suggest",e)},expression:"bugForm.suggest"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"页面图片列表"}},[i("div",t._l(t.bugForm.imglist,function(t,e){return i("el-image",{key:e,staticStyle:{width:"200px"},attrs:{src:t,"preview-src-list":[t]}})}),1)])],1)],1)],1)],1)])},staticRenderFns:[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("thead",[i("tr",[i("th",[i("div")]),t._v(" "),i("th",[i("div",[t._v("序号")])]),t._v(" "),i("th",[i("div",[t._v("提报人")])]),t._v(" "),i("th",[i("div",[t._v("项目名称")])]),t._v(" "),i("th",[i("div",[t._v("页面名称")])]),t._v(" "),i("th",[i("div",[t._v("系统问题描述")])]),t._v(" "),i("th",[i("div",[t._v("预计完成时间")])]),t._v(" "),i("th",[i("div",[t._v("IT部确认时间")])]),t._v(" "),i("th",[i("div",[t._v("状态")])])])])}]};var r=i("VU/8")(o,n,!1,function(t){i("KDDh"),i("iH7y")},"data-v-948f799e",null);e.default=r.exports}});
//# sourceMappingURL=29.7d4995f1a31e48313953.js.map