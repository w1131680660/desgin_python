webpackJsonp([58],{hJAK:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("mvHQ"),l=a.n(i),n=a("bOdI"),s=a.n(n),d=a("mtWM"),o=a.n(d),r={data:function(){var t;return t={centerDialogVisible:!1,centerDialogVisible2:!1,addContainer:"",addCountry:"",addStoreType:"",addStoreName:"",addShipmentDate:"",addCabinet:"",addSite:"",addPlatform:"",file:""},s()(t,"file",""),s()(t,"addCountryList",[]),s()(t,"addStoreTypeList",[]),s()(t,"addStoreNameList",[]),s()(t,"addCabinetList",[]),s()(t,"addCloneData",[]),s()(t,"addSiteList",[]),s()(t,"addPlatformList",[]),s()(t,"tableData",[]),s()(t,"addSkuList",[]),s()(t,"fileName",""),s()(t,"fileName2",""),s()(t,"submitContainer",""),s()(t,"submitPlatform",""),s()(t,"submitCountry",""),s()(t,"submitSite",""),s()(t,"submitStoreType",""),s()(t,"submitStoreName",""),s()(t,"submitFile",""),s()(t,"submitFile2",""),s()(t,"submitDate",""),s()(t,"submitCabinet",""),s()(t,"submitTable",[]),s()(t,"allSkuNum",0),s()(t,"errflag",!1),s()(t,"thList",[]),t},methods:{goScheduleDetail:function(t){t&&this.$router.push({path:"ScheduleDetail",query:{id:t}})},getDefaultTable:function(){var t=this;o()({url:this._url2+"server/stock_management/schedule_home_page",method:"get"}).then(function(e){for(var a in console.log(e),t.tableData=e.data.re_data,t.addCabinetList=e.data.re_list[1],t.addPlatformList=e.data.re_list[2],t.addSkuList=e.data.sku_data,t.addCloneData=e.data.warehouse_data,t.addStoreTypeList=[],e.data.warehouse_data){var i={value:a,label:a};t.addStoreTypeList.push(i)}var l=12;for(var n in t.tableData)t.tableData[n].length>l&&(l=t.tableData[n].length);if(l<13){for(var s in t.tableData)for(var d=t.tableData[s].length-1;d<13;d++)t.tableData[s].push("1");t.thList=[1,2,3,4,5,6,7,8,9,10,11,12,13]}else{for(var o in t.tableData)for(var r=t.tableData[o].length-1;r<l-1;r++)t.tableData[o].push("1");for(var u=0;u<l-1;u++)t.thList.push(u)}}),o()({url:this._url2+"server/personnel_management/get_sign_country/",method:"get"}).then(function(e){for(var a=e.data.data,i=0;i<a.length;i++){var l={label:a[i],value:a[i]};t.addCountryList.push(l)}})},getSite:function(){},fileSubmit:function(t){this.file=t.target.files[0],this.fileName=t.target.value},fileSubmit2:function(t){var e=this;if(this.addContainer)if(this.fileName2=t.target.value,console.log(this.fileName2),-1==this.fileName2.indexOf("订单数据")||-1==this.fileName2.indexOf(this.addContainer))alert("请上传正确的下单表（文件名要包含订单数据、货柜号）"),t.target.value="";else{this.file2=t.target.files[0];var a=new FormData;a.append("file",this.file2),this.$axios.post(this._url2+"server/stock_management/place_order_page/",a).then(function(t){if(console.log(t,123),200==t.data.code){e.allSkuNum=0,console.log(t),e.addSkuList=t.data.data;for(var a=0;a<e.addSkuList.length;a++)e.allSkuNum+=e.addSkuList[a].num}else 500==t.data.code&&(alert(t.data.error_msg),e.errflag=!0,e.addSkuList=t.data.error_data)})}else alert("清先填写货柜号再提交下单表获取SKU"),t.target.value=""},openSubmitDia:function(){var t=this.addContainer.match(/^[a-zA-Z]\d*$/g),e=this.fileName.lastIndexOf("."),a=this.fileName.substr(e+1),i=0;-1!=this.fileName.indexOf(this.addContainer)&&-1!=this.fileName.indexOf(this.addSite)&&-1!=this.fileName.indexOf("测算表")&&-1!=this.fileName2.indexOf("订单数据")&&-1!=this.fileName2.indexOf(this.addContainer)||i++;var l="";if(l=!!t,0==i&&1==l&&""!=this.addContainer&&""!=this.addCountry&&""!=this.addCabinet&&""!=this.addStoreType&&""!=this.file&&""!=this.addStoreName&&""!=this.addSite&&""!=this.addPlatform&&"xlsx"==a){this.submitTable=[],this.submitContainer=this.addContainer,this.submitCountry=this.addCountry,this.submitPlatform=this.addPlatform,this.submitSite=this.addSite,this.submitStoreType=this.addStoreType,this.submitStoreName=this.addStoreName,this.submitFile=this.fileName,this.submitFile2=this.fileName2,this.submitDate=this.addShipmentDate,this.submitCabinet=this.addCabinet,this.centerDialogVisible2=!0;for(var n=document.querySelectorAll(".inputCheck"),s=document.querySelectorAll(".allNum"),d=0;d<n.length;d++)if(1==n[d].checked){var o=n[d].value.split(",");o.push(s[d].value),this.submitTable.push(o)}}else alert("请填写填写国家、站点、平台、仓库类型、仓库名称、测算文件、日期、柜型（柜号格式为首字母加数字,文件类型必须为xsls,且文件名要有正确的柜号和站点。）")},addSubmit:function(){var t=this,e=this.addContainer.match(/^[a-zA-Z]\d*$/g),a=this.fileName.lastIndexOf("."),i=this.fileName.substr(a+1),n=0;-1!=this.fileName.indexOf(this.addContainer)&&-1!=this.fileName.indexOf(this.addSite)&&-1!=this.fileName.indexOf("测算表")||n++;var s="";if(s=!!e,0==n&&1==s&&""!=this.addContainer&&""!=this.addCountry&&""!=this.addCabinet&&""!=this.addStoreType&&""!=this.file&&""!=this.addStoreName&&""!=this.addSite&&""!=this.addPlatform&&"xlsx"==i){for(var d=document.querySelectorAll(".inputCheck"),o=document.querySelectorAll(".allNum"),r=sessionStorage.getItem("user_name"),u=[],c=0;c<d.length;c++)if(1==d[c].checked){var v=d[c].value.split(",");v.push(o[c].value),u.push(v)}u.length>=1&&(u=l()(u)),console.log(u);var h=this.addContainer+"-"+this.addCountry+"-"+this.addCabinet,p=new FormData;p.append("schedule_date",this.addShipmentDate),p.append("container_num",this.addContainer),p.append("country",this.addCountry),p.append("container_type",this.addCabinet),p.append("warehouse_type",this.addStoreType),p.append("calculation_file_path",this.file),p.append("warehouse_name",this.addStoreName),p.append("container_data",h),p.append("site",this.addSite),p.append("platform",this.addPlatform),p.append("sku_num",u),p.append("user_name",r),p.append("state","未审核"),p.append("integrated_state","未集成"),this.$axios.post(this._url2+"server/stock_management/schedule_home_page",p).then(function(e){200==e.data.code?(t.centerDialogVisible=!1,t.centerDialogVisible2=!1,t.getDefaultTable(),alert("新增成功")):500==e.data.code&&alert("已有货柜号，请重新上传")})}else alert("请填写填写国家、站点、平台、仓库类型、仓库名称、测算文件、日期、柜型（柜号格式为首字母加数字,文件类型必须为xsls,且文件名要有正确的柜号和站点。）")},tagCheck:function(){for(var t=document.querySelectorAll(".inputCheck"),e=document.querySelectorAll(".allNum"),a=0;a<t.length;a++)1==t[a].checked?e[a].removeAttribute("disabled"):e[a].setAttribute("disabled","disabled")},goOpDataUpload:function(){this.$router.push("/OpDataUpload")},goOpDataCheck:function(){var t=this;this.$axios({url:this._url2+"server/stock_management/is_open/",method:"get"}).then(function(e){200==e.data.code?t.$router.push("/OpDataCheck"):alert("你没有权限进入这个页面")})},close_specification:function(){document.querySelector(".specification").style.display="none"},open_specification:function(){document.querySelector(".specification").style.display="block"}},created:function(){this.getDefaultTable()},watch:{addStoreType:function(){for(var t in this.addStoreNameList=[],this.addStoreName="",this.addCloneData)if(this.addStoreType==t)for(var e=0;e<this.addCloneData[t].length;e++){var a={value:this.addCloneData[t][e],label:this.addCloneData[t][e]};this.addStoreNameList.push(a)}},addCountry:function(){var t=this;this.addSite="",o()({url:this._url2+"server/personnel_management/get_sign_area/",method:"get",params:{country:this.addCountry}}).then(function(e){t.addSiteList=[];for(var a=e.data.data,i=0;i<a.length;i++){var l={value:a[i],label:a[i]};t.addSiteList.push(l)}})}}},u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t._m(0),t._v(" "),a("div",{staticClass:"specification"},[a("h1",[t._v("新增货柜操作说明书")]),t._v(" "),a("h4",[t._v("\n      下单表文件名的货柜号要和输入框的货柜号一致且文件名要有订单数据（具体请下载下单表模板）\n    ")]),t._v(" "),a("div",{staticClass:"line3"}),t._v(" "),a("p",{staticStyle:{padding:"0 2vw"}},[t._v("\n      上传订单数据是为了在右侧生成下单的数据,故不需要你们填写，需要注意订单数据的数据是否正确。提交后会在订单集里成呈现，一键下单后，等待供应链的订单分发完，就可以在运营资料上传页面上传对应工厂的资料了。\n    ")]),t._v(" "),a("div",{staticClass:"cicle1"},[a("div",{staticClass:"cicle2",on:{click:function(e){return t.close_specification()}}},[a("div",{staticClass:"line1"}),t._v(" "),a("div",{staticClass:"line2"})])])]),t._v(" "),a("div",{staticStyle:{width:"100%","overflow-x":"auto"}},[a("table",[a("thead",[a("tr",[a("th",[t._v("日期")]),t._v(" "),a("th",[t._v("星期")]),t._v(" "),t._l(t.thList,function(e,i){return a("th",{key:i},[t._v("\n            "+t._s(i+1)+"\n          ")])})],2)]),t._v(" "),a("tbody",t._l(t.tableData,function(e,i){return a("tr",{key:i},[a("td",[t._v(t._s(i))]),t._v(" "),a("td",[t._v(t._s(e[0]))]),t._v(" "),t._l(e.slice(1),function(e,i){return a("td",{key:i,class:e.color?e.color:"",attrs:{id:"goDeatil"},on:{click:function(a){return t.goScheduleDetail(e.container_num)}}},[t._v("\n            "+t._s(e.container_data)+"\n          ")])})],2)}),0)])]),t._v(" "),a("div",{staticStyle:{"text-align":"center"}},[a("a",{staticClass:"open_specification",attrs:{href:"javascript:;"},on:{click:function(e){return t.open_specification()}}},[t._v("打开说明书")]),t._v(" "),a("a",{staticClass:"open_specification2",attrs:{href:"https://www.beyoung.group/file_download/?path=operation/operating_data/&filename=D1000-订单数据.xlsx"}},[t._v("下单表模板")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.centerDialogVisible=!0}}},[t._v("新 增 货 柜")]),t._v(" "),a("el-button",{staticStyle:{margin:"auto"},attrs:{type:"warning"},on:{click:function(e){return t.goOpDataUpload()}}},[t._v("资 料 上 传")]),t._v(" "),a("el-button",{staticStyle:{margin:"auto"},attrs:{type:"warning"},on:{click:function(e){return t.goOpDataCheck()}}},[t._v("资 料 审 核")])],1),t._v(" "),a("el-dialog",{attrs:{title:"新增货柜",visible:t.centerDialogVisible,"close-on-click-modal":!1,width:"60%",center:""},on:{"update:visible":function(e){t.centerDialogVisible=e}}},[a("span",[a("div",{staticStyle:{display:"flex"}},[a("div",{staticClass:"dialogLeft",staticStyle:{flex:"5"}},[a("div",[t._v("柜号：")]),t._v(" "),a("div",[t._v("平台：")]),t._v(" "),a("div",[t._v("国家：")]),t._v(" "),a("div",[t._v("站点：")]),t._v(" "),a("div",[t._v("仓库类型：")]),t._v(" "),a("div",[t._v("仓库名称：")]),t._v(" "),a("div",[t._v("测算：")]),t._v(" "),a("div",[t._v("订单数据：")]),t._v(" "),a("div",[t._v("预计出货日期：")]),t._v(" "),a("div",[t._v("柜型：")])]),t._v(" "),a("div",{staticClass:"dialogRight",staticStyle:{flex:"12"}},[a("div",[a("el-input",{staticStyle:{width:"10.4vw"},attrs:{placeholder:"请输入内容"},model:{value:t.addContainer,callback:function(e){t.addContainer=e},expression:"addContainer"}})],1),t._v(" "),a("div",[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.addPlatform,callback:function(e){t.addPlatform=e},expression:"addPlatform"}},t._l(t.addPlatformList,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),a("div",[a("el-select",{attrs:{placeholder:"请选择"},on:{change:function(e){return t.getSite()}},model:{value:t.addCountry,callback:function(e){t.addCountry=e},expression:"addCountry"}},t._l(t.addCountryList,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),a("div",[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.addSite,callback:function(e){t.addSite=e},expression:"addSite"}},t._l(t.addSiteList,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),a("div",[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.addStoreType,callback:function(e){t.addStoreType=e},expression:"addStoreType"}},t._l(t.addStoreTypeList,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),a("div",[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.addStoreName,callback:function(e){t.addStoreName=e},expression:"addStoreName"}},t._l(t.addStoreNameList,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),a("div",{staticStyle:{position:"relative"}},[a("input",{attrs:{type:"file"},on:{change:t.fileSubmit}}),t._v(" "),a("p",{staticStyle:{color:"red",position:"absolute",top:"11px",left:"0",width:"500px","font-size":"12px"}},[t._v('\n              文件命名规范："站点国家-xxxx-货柜号-FBA/FBM-上传人-日期-测算表"\n            ')])]),t._v(" "),a("div",[a("input",{attrs:{type:"file"},on:{change:t.fileSubmit2}})]),t._v(" "),a("div",[a("el-date-picker",{staticStyle:{width:"10.4vw"},attrs:{format:"yyyy 年 MM 月 dd 日","value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},model:{value:t.addShipmentDate,callback:function(e){t.addShipmentDate=e},expression:"addShipmentDate"}})],1),t._v(" "),a("div",[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.addCabinet,callback:function(e){t.addCabinet=e},expression:"addCabinet"}},t._l(t.addCabinetList,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1)]),t._v(" "),a("div",{staticStyle:{flex:"30"}},[a("h4",{staticStyle:{"text-align":"center"}},[t._v("\n            "+t._s(1==t.errflag?"错误的SKU（请修改正确SKU再刷新页面再上传）":"SKU(请上传订单文件获取)")+"\n          ")]),t._v(" "),a("ul",{staticClass:"myul",staticStyle:{width:"100%"}},[t._l(t.addSkuList,function(e,i){return a("li",{key:i,class:1==t.errflag?"errbgc":"",staticStyle:{float:"left",width:"95%","font-size":"0.9rem"}},[a("div",{staticStyle:{float:"left",width:"0.8vw","border-right":"2px #dddddd solid"}},[a("input",{staticClass:"inputCheck",attrs:{type:"checkbox",disabled:"",checked:""},domProps:{value:[e.sku,e.product_code]},on:{click:function(e){return t.tagCheck()}}})]),t._v("\n              "+t._s(e.sku)+": "+t._s(e.commodity_name)+" 数量：\n              "),a("input",{staticClass:"allNum",staticStyle:{width:"3vw"},attrs:{type:"number",disabled:"",readonly:""},domProps:{value:e.num}})])}),t._v(" "),a("li",{staticStyle:{float:"left",width:"95%","font-size":"0.9rem"}},[a("div",[t._v("总计数量："+t._s(t.allSkuNum))])])],2)])])]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",disabled:t.errflag},on:{click:function(e){return t.openSubmitDia()}}},[t._v("提 交")]),t._v(" "),a("el-button",{attrs:{type:"info"},on:{click:function(e){t.centerDialogVisible=!1}}},[t._v("取 消")])],1)]),t._v(" "),a("el-dialog",{attrs:{title:"请确认您要提交的数据",visible:t.centerDialogVisible2,width:"60%",center:""},on:{"update:visible":function(e){t.centerDialogVisible2=e}}},[a("span",{staticStyle:{display:"flex"}},[a("div",{staticClass:"dialogLeft",staticStyle:{flex:"5"}},[a("div",[t._v("柜号：")]),t._v(" "),a("div",[t._v("平台：")]),t._v(" "),a("div",[t._v("国家：")]),t._v(" "),a("div",[t._v("站点：")]),t._v(" "),a("div",[t._v("仓库类型：")]),t._v(" "),a("div",[t._v("仓库名称：")]),t._v(" "),a("div",[t._v("测算文件：")]),t._v(" "),a("div",[t._v("下单表文件：")]),t._v(" "),a("div",[t._v("预计出货日期：")]),t._v(" "),a("div",[t._v("柜型：")])]),t._v(" "),a("div",{staticClass:"dialogRight",staticStyle:{flex:"12"}},[a("div",[a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.submitContainer,callback:function(e){t.submitContainer=e},expression:"submitContainer"}})],1),t._v(" "),a("div",[a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.submitPlatform,callback:function(e){t.submitPlatform=e},expression:"submitPlatform"}})],1),t._v(" "),a("div",[a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.submitCountry,callback:function(e){t.submitCountry=e},expression:"submitCountry"}})],1),t._v(" "),a("div",[a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.submitSite,callback:function(e){t.submitSite=e},expression:"submitSite"}})],1),t._v(" "),a("div",[a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.submitStoreType,callback:function(e){t.submitStoreType=e},expression:"submitStoreType"}})],1),t._v(" "),a("div",[a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.submitStoreName,callback:function(e){t.submitStoreName=e},expression:"submitStoreName"}})],1),t._v(" "),a("div",[a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.submitFile,callback:function(e){t.submitFile=e},expression:"submitFile"}})],1),t._v(" "),a("div",[a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.submitFile2,callback:function(e){t.submitFile2=e},expression:"submitFile2"}})],1),t._v(" "),a("div",[a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.submitDate,callback:function(e){t.submitDate=e},expression:"submitDate"}})],1),t._v(" "),a("div",[a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.submitCabinet,callback:function(e){t.submitCabinet=e},expression:"submitCabinet"}})],1)]),t._v(" "),a("div",{staticStyle:{flex:"30"}},[a("table",[a("thead",[a("tr",[a("th",[t._v("序号")]),t._v(" "),a("th",[t._v("sku")]),t._v(" "),a("th",[t._v("数量")])])]),t._v(" "),a("tbody",[t._l(t.submitTable,function(e,i){return a("tr",{key:i},[a("td",[t._v(t._s(i+1))]),t._v(" "),a("td",[t._v(t._s(e[0]))]),t._v(" "),a("td",[t._v(t._s(e[2]))])])}),t._v(" "),a("tr",[a("td",[t._v("合计")]),t._v(" "),a("td"),t._v(" "),a("td",[t._v(t._s(t.allSkuNum))])])],2)])])]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addSubmit()}}},[t._v("确 定")]),t._v(" "),a("el-button",{attrs:{type:"info"},on:{click:function(e){t.centerDialogVisible2=!1}}},[t._v("取 消")])],1)])],1)},staticRenderFns:[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{height:"50px",display:"flex",padding:"15px",background:"rgba(255, 255, 255, 0.9)"}},[a("div",{staticStyle:{width:"8%"}},[t._v("\n      已拖柜:\n      "),a("span",{staticStyle:{display:"inline-block",margin:"0",padding:"0",height:"25px",width:"60px","background-color":"green"}})]),t._v(" "),a("div",{staticStyle:{width:"7%"}},[t._v("\n      延期:\n      "),a("span",{staticStyle:{display:"inline-block",margin:"0",padding:"0",height:"25px",width:"60px","background-color":"yellow"}})]),t._v(" "),a("div",{staticStyle:{width:"9%"}},[t._v("\n      柜子取消:\n      "),a("span",{staticStyle:{display:"inline-block",margin:"0",padding:"0",height:"25px",width:"60px","background-color":"red"}})]),t._v(" "),a("div",{staticStyle:{width:"8%"}},[t._v("\n      已拖柜:\n      "),a("span",{staticStyle:{display:"inline-block",margin:"0",padding:"0",height:"25px",width:"60px","background-color":"green"}})]),t._v(" "),a("div",{staticStyle:{width:"8%","margin-right":"15px"}},[t._v("\n      确定拖柜:\n      "),a("span",{staticStyle:{display:"inline-block",margin:"0",padding:"0",height:"25px",width:"60px","background-color":"blue"}})]),t._v(" "),a("div",{staticStyle:{width:"8%"}},[t._v("暂定拖柜:无颜色")])])}]};var c=a("VU/8")(r,u,!1,function(t){a("xLBh")},"data-v-ffdde8c4",null);e.default=c.exports},xLBh:function(t,e){}});
//# sourceMappingURL=58.387dd7b3a0faea361d40.js.map