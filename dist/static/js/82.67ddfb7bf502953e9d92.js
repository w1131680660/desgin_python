webpackJsonp([82],{RlUg:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a("d7EF"),s=a.n(o),r={data:function(){return{uploading:!1,listData:[{country:"英国",listArr:["fileA","fileB","fileC","fileD"]}],acceptType:[{label:"广告报告",type:"xls"},{label:"订单报告",type:"txt"},{label:"fba",type:"txt"}],form:{country_station:"",date:"",type:""},country_stations_code:[],country_stations:[],uploadFlag:!1,curAcceptType:""}},computed:{times:function(){if(this.form.date){var t=this.form.date.split("-"),e=s()(t,3);return e[0]+"_"+e[1]+"_"+e[2]}return""}},methods:{submitData:function(){},submitUpload:function(){var t=this,e=this.$refs.upload.uploadFiles[0];if(console.log(e),e){var a=e.raw;if(a&&a.name)if(this.curAcceptType=this.acceptType.find(function(e){return e.label===t.form.type}).type,!new RegExp("."+this.curAcceptType,"g").test(a.name))return this.$refs.upload.uploadFiles=[],void alert("请上传"+this.curAcceptType+"后缀文件");if(this.uploadFlag=!0,this.form.country_station&&this.times&&this.uploadFlag){console.log("post请求发送");var o=new FormData;o.append("files",a);var s=this.country_stations.findIndex(function(e){return e==t.form.country_station}),r=this.country_stations_code[s];console.log(r),o.append("area",r),o.append("area1",this.form.country_station);var l=this.times.split("-").join("_");o.append("times",l),o.append("status",this.form.type),this.$refs.upload.submit(),this.uploading=!0;var i=this._url2+"server/order_management/upload_advertising_report/";console.log(i),this.$axios.post(i,o).then(function(e){t.uploading=!1,200===e.data.code?alert("上传成功！"):alert("上传未成功！"),console.log(t.$refs.upload),t.form.type="",t.form.country_station="",t.form.date="",t.$refs.upload.uploadFiles=[]})}else alert("请选择国家站点、时间并检查上传文件类型是否为"+this.curAcceptType+"后缀文件")}else alert("请上传文件")},getCountryList:function(){var t=this,e=this._url2+"server/order_management/get_upload_file_country/";this.$axios.get(e).then(function(e){console.log(e),t.country_stations_code=e.data.site_en||[],t.country_stations=e.data.site||[]})}},created:function(){this.getCountryList()}},l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"AdvertisingReportUpload"}},[a("el-form",{attrs:{inline:!0,model:t.form}},[a("el-form-item",{attrs:{label:"上传文件类型"}},[a("el-select",{model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},t._l(t.acceptType,function(t,e){return a("el-option",{key:e,attrs:{label:t.label,value:t.label}})}),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"国家站点"}},[a("el-select",{attrs:{placeholder:"请选择国家站点"},model:{value:t.form.country_station,callback:function(e){t.$set(t.form,"country_station",e)},expression:"form.country_station"}},t._l(t.country_stations,function(e,o){return a("el-option",{key:o,attrs:{label:e,value:t.country_stations[o]}})}),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"时间"}},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},model:{value:t.form.date,callback:function(e){t.$set(t.form,"date",e)},expression:"form.date"}})],1),t._v(" "),a("el-form-item",[a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:"123","auto-upload":!1,"http-request":t.submitData}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[t._v("文件上传")]),t._v(" "),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"success"},on:{click:t.submitUpload}},[t._v("确认上传")])],1)],1)],1),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.uploading,expression:"uploading"}],staticClass:"mask"},[t._v("\n    上传中，请稍等！\n  ")])],1)},staticRenderFns:[]};var i=a("VU/8")(r,l,!1,function(t){a("Yqaq")},null,null);e.default=i.exports},Yqaq:function(t,e){}});
//# sourceMappingURL=82.67ddfb7bf502953e9d92.js.map