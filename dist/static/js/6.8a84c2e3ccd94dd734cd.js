webpackJsonp([6],{"5K7/":function(t,e){},JLRG:function(t,e){},"KDt/":function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var l={name:"",props:{title:{type:String,default:function(){return""}},type:{type:String,default:function(){return""}}},components:{},data:function(){return{returnFile:[],selection:{platform:"",site:"",country:"",date:"",month:"",type:"",page_type:"",select_month:"",daterange:[]},platformList:["Amazon"],siteList:[],countryList:[],pickerOptions:{disabledDate:function(t){return t.getTime()>Date.now()},shortcuts:[{text:"今天",onClick:function(t){t.$emit("pick",new Date)}},{text:"昨天",onClick:function(t){var e=new Date;e.setTime(e.getTime()-864e5),t.$emit("pick",e)}},{text:"一周前",onClick:function(t){var e=new Date;e.setTime(e.getTime()-6048e5),t.$emit("pick",e)}}]},monthPickerOptions1:{disabledDate:function(t){return t.getTime()>Date.now()}},monthPickerOptions:{disabledDate:function(t){return t.getTime()>Date.now()}},isDateDisabled:!1,isMonthDisabled:!1,isStockDateDisabled:!1,isStockMonthDisabled:!1,file:"",stockCountryList:[],stockSiteList:[],stockSelection:{platform:"Amazon",site:"",country:"",date:"",month:"",type:"库存报告"},formRules:{platform:[{required:!0,message:"请选择渠道",trigger:"change"}],site:[{required:!0,message:"请选择站点",trigger:"change"}],country:[{required:!0,message:"请选择国家",trigger:"change"}],select_month:[{type:"string",required:!0,message:"请选择月份",trigger:"change"}],daterange:[{type:"array",required:!0,message:"请选择时间",trigger:"change"}]},dealAndGatherVisible:!1,dgForm:{platform:"",site:"",country:"",date:"",month:"",type:"",page_type:"",select_month:"",daterange:[]},settleVisible:!1,settleForm:{platform:"",site:"",country:"",date:"",month:"",type:"",page_type:"",select_month:"",daterange:[]},returnReportVisible:!1,rpForm:{platform:"",country:"",site:"",select_month:""},returnType:""}},computed:{countryList_:function(){var t=!1,e=[];for(var s in this.countryList){var l=this.countryList[s];l.includes("法国")||l.includes("德国")||l.includes("意大利")||l.includes("西班牙")?t=!0:e.push(l)}return!0===t&&e.push("欧洲"),console.log(this.countryList,e),e},handleExceed:function(){this.$message.error("只允许上传一个文件")},seleteDate:function(){return this.selection.date},seleteMonth:function(){return this.selection.month},stockSelectionDate:function(){return this.stockSelection.date},stockSelectionMonth:function(){return this.stockSelection.month},isVatReport:function(){return"VAT报告"===this.title},isStockReport:function(){return"库存报告"===this.title},isOrderReport:function(){return"所有订单报告"===this.title||"已完成订单报告"===this.title},isDealAndGatherReport:function(){return"汇总报告"===this.title||"交易报告"===this.title},isSettleReport:function(){return"结算周期报告"===this.title},isReturnReport:function(){return"退货报告"===this.title&&(this.returnType="退货报告"),"退款报告"===this.title&&(this.returnType="退款报告"),"退货报告"===this.title||"退款报告"===this.title}},watch:{seleteDate:function(t){null===t&&(this.isMonthDisabled=!1)},seleteMonth:function(t){null===t&&(this.isDateDisabled=!1)},stockSelectionDate:function(t){null===t&&(this.isStockMonthDisabled=!1)},stockSelectionMonth:function(t){null===t&&(this.isStockDateDisabled=!1)}},methods:{returnReport:function(){this.returnReportVisible=!0},rpDialogClose:function(){console.log("关闭"),this.$refs.rpForm.resetFields(),this.$refs.uploadRp.clearFiles(),this.file="",this.returnFile=[],this.returnReportVisible=!1},beforeUploadRp:function(t){this.file="",this.returnFile=[],console.log("上传之前",t),/\.txt$/g.test(t.name)?(this.file=t,this.returnFile.push(t)):alert("请上传txt文件!")},uploadFileRp:function(t){console.log("文件上传",t)},uploadSuccessRp:function(){console.log("上传成功")},handleRemoveRp:function(){this.file="",this.returnFile=[]},uploadReturnRp:function(t){var e=this;console.log(this.file),console.log("确认上传？？？"),this.$refs[t].validate(function(t){if(t){if(""===e.file)return e.$message.closeAll(),e.$message.error("请选择一个文件");console.log(e.file);var s=new FormData;s.append("platform",e.rpForm.platform),s.append("country",e.rpForm.country),s.append("site",e.rpForm.site),s.append("month",e.rpForm.select_month),s.append("file_path",e.file),s.append("type",e.returnType),e.$refs.uploadRp.clearFiles();var l=e._url2+"server/databases/return_report/";e.$axios.post(l,s).then(function(t){if(console.log(t),200===t.data.code)for(var s in e.$message.success("请求成功"),e.returnReportVisible=!1,e.rpForm)e.rpForm[s]=""})}})},getSelectList:function(){var t=this;this.$api.getSelectList().then(function(e){console.log(e),t.siteList=e.data.data})},siteChange:function(t){for(var e in this.siteList){var s=this.siteList[e];s.store==t&&(this.countryList=s.countries)}},getStockSelectList:function(){var t=this;this.$api.getPageSelect("库存报告").then(function(e){console.log(e),t.stockCountryList=e.data.country_list,t.stockSiteList=e.data.site_list})},getCountryList:function(){var t=this;this.$api.getCountryList().then(function(e){t.countryList=e.data.data,t.stockCountryList=e.data.data})},countrySelectChange:function(t){var e=this;this.selection.site="",this.siteList=[],this.$api.getSiteList(t).then(function(t){console.log(t),e.siteList=t.data.data,e.stockSiteList=t.data.data})},pickerChange:function(t){"库存报告"==this.title?(console.log("aaa"),"日期"==t?this.isStockMonthDisabled=!0:this.isStockDateDisabled=!0):"日期"==t?this.isMonthDisabled=!0:this.isDateDisabled=!0},creatReport:function(){var t=this;this.selection.type=this.type;var e=this.selection;return e.platform&&e.site&&e.country?e.date||e.month?void this.$api.getAllOrder(this.selection).then(function(e){console.log(e),t.$emit("createReport",e.data.data,t.selection)}):(this.$message.closeAll(),void this.$message.error("请选择日期或月份")):(this.$message.closeAll(),void this.$message.error("请选择选项"))},queryVatReport:function(){console.log(this.selection.month),this.$emit("queryVatReport",this.selection.month)},beforeUpload:function(t){var e=this;console.log(t),this.file=t;var s=new FormData;s.append("file",this.file),this.$api.uploadVatReport(s).then(function(t){console.log(t),e.file="",e.$message.success("上传成功"),e.$emit("refresh")})},uploadFile:function(t){},handleRemove:function(t){this.file=""},queryStockReport:function(){var t=this,e=this.stockSelection;return e.platform&&e.site&&e.country?e.date||e.month?void this.$api.getStockList(this.stockSelection).then(function(e){if(console.log(e),200!=e.data.code)return t.$message.error(e.data.msg);t.$emit("getStockReport",e.data.download_path,t.stockSelection)}):(this.$message.closeAll(),void this.$message.error("请选择日期或月份")):(this.$message.closeAll(),void this.$message.error("请选择选项"))},getReturnReport:function(){var t=this;if(""!==this.selection.platform&&""!==this.selection.country&&""!==this.selection.site){var e=this._url2+"server/databases/return_report/",s={};s.platform=this.selection.platform,s.country=this.selection.country,s.site=this.selection.site,s.month=this.selection.select_month,s.type=this.returnType,this.$axios.get(e,{params:s}).then(function(e){console.log("查询数据",e),0===e.data.re_data.length?t.$message.warning("查询不到数据!"):t.$emit("getReturnData",e.data.re_data)})}else this.$message.warning("请选择除了国家外的选项")},queryDealOrGatherSettleReport:function(t){var e=this;console.log(t);var s=this.selection;if(!s.platform||!s.site||!s.country)return this.$message.closeAll(),void this.$message.error("请选择选项，时间可选");this.selection.page_type=this.title,this.$api.getDealGatherSettleList(this.selection).then(function(t){if(console.log(t),200!=t.data.code)return e.$message.closeAll(),e.$message.error("没有符合条件的数据");e.$emit("getDealGatherSettleList",t.data.data)})},uploadDealGatherSettle:function(t){this.file=t,this.selection.page_type=this.title,this.dgForm.page_type=this.title,this.settleForm.page_type=this.title},uploadSuccess:function(t){},showDealAndGather:function(){this.stockSiteList=[],this.dealAndGatherVisible=!0},uploadDealAndGather:function(){var t=this;"结算周期报告"!==this.title?this.$refs.dealgatherRef.validate(function(e){if(e){if(""==t.file)return t.$message.closeAll(),t.$message.error("请选择一个文件");var s=new FormData;s.append("platform",t.dgForm.platform),s.append("country",t.dgForm.country),s.append("site",t.dgForm.site),s.append("file",t.file),s.append("page_type",t.dgForm.page_type),s.append("target_month",t.dgForm.select_month),"结算周期报告"==t.title&&(console.log("是结算报告"),console.log(t.dgForm.daterange[0]),console.log(t.dgForm.daterange[1]),s.append("start_date",t.dgForm.daterange[0]),s.append("end_date",t.dgForm.daterange[1])),t.$api.uploadDealGatherSettle(s).then(function(e){console.log(e),t.dealAndGatherVisible=!1,t.$message.success("上传成功"),t.$api.getDealGatherSettleList(t.dgForm).then(function(e){console.log(e),t.$emit("getDealGatherSettleList",e.data.data)})}),t.$refs.upload.clearFiles(),t.file="",t.stockSiteList=[]}}):this.$refs.settleRef.validate(function(e){if(e){if(""==t.file)return t.$message.closeAll(),t.$message.error("请选择一个文件");var s=new FormData;s.append("platform",t.settleForm.platform),s.append("country",t.settleForm.country),s.append("site",t.settleForm.site),s.append("file",t.file),s.append("page_type",t.settleForm.page_type),"结算周期报告"==t.title&&(console.log("是结算报告"),console.log(t.settleForm.daterange[0]),console.log(t.settleForm.daterange[1]),s.append("start_date",t.settleForm.daterange[0]),s.append("end_date",t.settleForm.daterange[1])),t.$api.uploadDealGatherSettle(s).then(function(e){console.log(e),t.settleVisible=!1,t.$message.success("上传成功"),t.$api.getDealGatherSettleList(t.settleForm).then(function(e){console.log(e),t.$emit("getDealGatherSettleList",e.data.data)})}),t.$refs.upload.clearFiles(),t.file="",t.stockSiteList=[]}})},dgDialogClose:function(){this.$refs.dealgatherRef.resetFields(),this.$refs.upload.clearFiles(),this.file="",this.stockSiteList=[]},showSettle:function(){this.stockSiteList=[],this.settleVisible=!0},settleDialogClose:function(){this.$refs.settleRef.resetFields(),this.$refs.upload.clearFiles(),this.file="",this.stockSiteList=[]}},created:function(){this.getCountryList(),console.log(this.$refs)},mounted:function(){}},o={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"sort-selection"},[s("div",[s("span",{staticClass:"titleSpan"},[t._v(t._s(t.title))]),t._v(" "),t.isDealAndGatherReport?s("el-button",{staticClass:"upload_btn",attrs:{type:"primary",size:"mini"},on:{click:t.showDealAndGather}},[t._v("上传文件")]):t._e(),t._v(" "),t.isSettleReport?s("el-button",{staticClass:"upload_btn",attrs:{type:"primary",size:"mini"},on:{click:t.showSettle}},[t._v("上传文件")]):t._e(),t._v(" "),t.isReturnReport?s("el-button",{staticClass:"upload_btn",attrs:{size:"mini",type:"primary"},on:{click:t.returnReport}},[t._v("\n      上传文件\n    ")]):t._e()],1),t._v(" "),t.isOrderReport?s("div",{staticClass:"all-select"},[s("div",{staticClass:"select"},[s("span",[t._v("渠道:")]),t._v(" "),s("el-select",{attrs:{placeholder:"请选择",size:"small"},model:{value:t.selection.platform,callback:function(e){t.$set(t.selection,"platform",e)},expression:"selection.platform"}},t._l(t.platformList,function(t,e){return s("el-option",{key:e,attrs:{label:t,value:t}})}),1)],1),t._v(" "),s("div",{staticClass:"select"},[s("span",[t._v("国家:")]),t._v(" "),s("el-select",{attrs:{placeholder:"请选择",size:"small"},on:{change:t.countrySelectChange},model:{value:t.selection.country,callback:function(e){t.$set(t.selection,"country",e)},expression:"selection.country"}},t._l(t.countryList_,function(t,e){return s("el-option",{key:e,attrs:{label:t,value:t}})}),1)],1),t._v(" "),s("div",{staticClass:"select"},[s("span",[t._v("站点:")]),t._v(" "),s("el-select",{attrs:{placeholder:"请选择",size:"small"},model:{value:t.selection.site,callback:function(e){t.$set(t.selection,"site",e)},expression:"selection.site"}},t._l(t.siteList,function(t,e){return s("el-option",{key:e,attrs:{label:t,value:t}})}),1)],1),t._v(" "),s("div",{staticClass:"select"},[s("span",[t._v("时间：")]),t._v(" "),s("el-date-picker",{attrs:{align:"right",type:"date",placeholder:"选择日期","picker-options":t.pickerOptions,format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",disabled:t.isDateDisabled,size:"small"},on:{change:function(e){return t.pickerChange("日期")}},model:{value:t.selection.date,callback:function(e){t.$set(t.selection,"date",e)},expression:"selection.date"}})],1),t._v(" "),s("div",{staticClass:"select month"},[s("span",[t._v("或月份：")]),t._v(" "),s("el-date-picker",{attrs:{type:"month",placeholder:"选择日期",format:"yyyy-MM","value-format":"yyyy-MM",disabled:t.isMonthDisabled,size:"small","picker-options":t.monthPickerOptions1},on:{change:function(e){return t.pickerChange("月份")}},model:{value:t.selection.month,callback:function(e){t.$set(t.selection,"month",e)},expression:"selection.month"}}),t._v(" "),s("el-button",{staticStyle:{"margin-left":"6px"},attrs:{type:"primary",size:"mini"},on:{click:t.creatReport}},[t._v("生成")])],1)]):t._e(),t._v(" "),t.isVatReport?s("div",{staticClass:"all-select"},[s("div",{staticClass:"select month",staticStyle:{display:"flex"}},[s("span",[t._v("月份：")]),t._v(" "),s("el-date-picker",{attrs:{type:"month",placeholder:"选择日期",format:"yyyy-MM","value-format":"yyyy-MM",size:"small","picker-options":t.monthPickerOptions},model:{value:t.selection.month,callback:function(e){t.$set(t.selection,"month",e)},expression:"selection.month"}}),t._v(" "),s("el-button",{staticStyle:{margin:"0 15px"},attrs:{type:"primary",size:"mini"},on:{click:t.queryVatReport}},[t._v("查询")]),t._v(" "),s("el-upload",{staticClass:"upload-demo",attrs:{action:"123",limit:1,"before-upload":t.beforeUpload,"http-request":t.uploadFile}},[s("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")])],1)],1)]):t._e(),t._v(" "),t.isStockReport?s("div",{staticClass:"all-select"},[s("div",{staticClass:"select"},[s("span",[t._v("渠道:")]),t._v(" "),s("el-select",{attrs:{placeholder:"请选择",size:"small"},model:{value:t.stockSelection.platform,callback:function(e){t.$set(t.stockSelection,"platform",e)},expression:"stockSelection.platform"}},t._l(t.platformList,function(t,e){return s("el-option",{key:e,attrs:{label:t,value:t}})}),1)],1),t._v(" "),s("div",{staticClass:"select"},[s("span",[t._v("国家:")]),t._v(" "),s("el-select",{attrs:{placeholder:"请选择",size:"small"},on:{change:t.countrySelectChange},model:{value:t.stockSelection.country,callback:function(e){t.$set(t.stockSelection,"country",e)},expression:"stockSelection.country"}},t._l(t.stockCountryList,function(t,e){return s("el-option",{key:e,attrs:{label:t,value:t}})}),1)],1),t._v(" "),s("div",{staticClass:"select"},[s("span",[t._v("站点:")]),t._v(" "),s("el-select",{attrs:{placeholder:"请选择",size:"small"},model:{value:t.stockSelection.site,callback:function(e){t.$set(t.stockSelection,"site",e)},expression:"stockSelection.site"}},t._l(t.stockSiteList,function(t,e){return s("el-option",{key:e,attrs:{label:t,value:t}})}),1)],1),t._v(" "),s("div",{staticClass:"select"},[s("span",[t._v("日期：")]),t._v(" "),s("el-date-picker",{attrs:{align:"right",type:"date",placeholder:"选择日期","picker-options":t.pickerOptions,format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",disabled:t.isStockDateDisabled,size:"small"},on:{change:function(e){return t.pickerChange("日期")}},model:{value:t.stockSelection.date,callback:function(e){t.$set(t.stockSelection,"date",e)},expression:"stockSelection.date"}})],1),t._v(" "),s("div",{staticClass:"select month"},[s("span",[t._v("或月份：")]),t._v(" "),s("el-date-picker",{attrs:{type:"month",placeholder:"选择日期",format:"yyyy-MM","value-format":"yyyy-MM",disabled:t.isStockMonthDisabled,size:"small","picker-options":t.monthPickerOptions},on:{change:function(e){return t.pickerChange("月份")}},model:{value:t.stockSelection.month,callback:function(e){t.$set(t.stockSelection,"month",e)},expression:"stockSelection.month"}}),t._v(" "),s("el-button",{staticStyle:{"margin-left":"6px"},attrs:{type:"primary",size:"mini"},on:{click:t.queryStockReport}},[t._v("查 询")])],1)]):t._e(),t._v(" "),t.isDealAndGatherReport?s("div",{staticClass:"all-select"},[s("div",{staticClass:"select"},[s("span",[t._v("渠道:")]),t._v(" "),s("el-select",{attrs:{placeholder:"请选择",size:"small"},model:{value:t.selection.platform,callback:function(e){t.$set(t.selection,"platform",e)},expression:"selection.platform"}},t._l(t.platformList,function(t,e){return s("el-option",{key:e,attrs:{label:t,value:t}})}),1)],1),t._v(" "),s("div",{staticClass:"select"},[s("span",[t._v("国家:")]),t._v(" "),s("el-select",{attrs:{placeholder:"请选择",size:"small"},on:{change:t.countrySelectChange},model:{value:t.selection.country,callback:function(e){t.$set(t.selection,"country",e)},expression:"selection.country"}},t._l(t.stockCountryList,function(t,e){return s("el-option",{key:e,attrs:{label:t,value:t}})}),1)],1),t._v(" "),s("div",{staticClass:"select"},[s("span",[t._v("站点:")]),t._v(" "),s("el-select",{attrs:{placeholder:"请选择",size:"small"},model:{value:t.selection.site,callback:function(e){t.$set(t.selection,"site",e)},expression:"selection.site"}},t._l(t.stockSiteList,function(t,e){return s("el-option",{key:e,attrs:{label:t,value:t}})}),1)],1),t._v(" "),s("div",{staticClass:"select month"},[s("span",[t._v("月份：")]),t._v(" "),s("el-date-picker",{attrs:{type:"month",placeholder:"选择日期",format:"yyyy-MM","value-format":"yyyy-MM",size:"small","picker-options":t.monthPickerOptions},model:{value:t.selection.select_month,callback:function(e){t.$set(t.selection,"select_month",e)},expression:"selection.select_month"}}),t._v(" "),s("el-button",{staticStyle:{"margin-left":"6px"},attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.queryDealOrGatherSettleReport(t.title)}}},[t._v("生成")])],1)]):t._e(),t._v(" "),t.isSettleReport?s("div",{staticClass:"all-select"},[s("div",{staticClass:"select"},[s("span",[t._v("渠道:")]),t._v(" "),s("el-select",{attrs:{placeholder:"请选择",size:"small"},model:{value:t.selection.platform,callback:function(e){t.$set(t.selection,"platform",e)},expression:"selection.platform"}},t._l(t.platformList,function(t,e){return s("el-option",{key:e,attrs:{label:t,value:t}})}),1)],1),t._v(" "),s("div",{staticClass:"select"},[s("span",[t._v("国家:")]),t._v(" "),s("el-select",{attrs:{placeholder:"请选择",size:"small"},on:{change:t.countrySelectChange},model:{value:t.selection.country,callback:function(e){t.$set(t.selection,"country",e)},expression:"selection.country"}},t._l(t.stockCountryList,function(t,e){return s("el-option",{key:e,attrs:{label:t,value:t}})}),1)],1),t._v(" "),s("div",{staticClass:"select"},[s("span",[t._v("站点:")]),t._v(" "),s("el-select",{attrs:{placeholder:"请选择",size:"small"},model:{value:t.selection.site,callback:function(e){t.$set(t.selection,"site",e)},expression:"selection.site"}},t._l(t.stockSiteList,function(t,e){return s("el-option",{key:e,attrs:{label:t,value:t}})}),1)],1),t._v(" "),s("div",{staticClass:"select"},[s("span",[t._v("时间：")]),t._v(" "),s("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd","picker-options":t.pickerOptions},model:{value:t.selection.daterange,callback:function(e){t.$set(t.selection,"daterange",e)},expression:"selection.daterange"}}),t._v(" "),s("el-button",{staticStyle:{"margin-left":"6px"},attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.queryDealOrGatherSettleReport(t.title)}}},[t._v("生成")])],1)]):t._e(),t._v(" "),s("el-dialog",{attrs:{visible:t.dealAndGatherVisible,width:"30%",center:"","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(e){t.dealAndGatherVisible=e},close:t.dgDialogClose}},[s("el-form",{ref:"dealgatherRef",staticClass:"demo-ruleForm",attrs:{model:t.dgForm,rules:t.formRules,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"渠道：",prop:"platform"}},[s("el-select",{attrs:{placeholder:"请选择",size:"small"},model:{value:t.dgForm.platform,callback:function(e){t.$set(t.dgForm,"platform",e)},expression:"dgForm.platform"}},t._l(t.platformList,function(t,e){return s("el-option",{key:e,attrs:{label:t,value:t}})}),1)],1),t._v(" "),s("el-form-item",{attrs:{label:"国家：",prop:"country"}},[s("el-select",{attrs:{placeholder:"请选择",size:"small"},on:{change:t.countrySelectChange},model:{value:t.dgForm.country,callback:function(e){t.$set(t.dgForm,"country",e)},expression:"dgForm.country"}},t._l(t.stockCountryList,function(t,e){return s("el-option",{key:e,attrs:{label:t,value:t}})}),1)],1),t._v(" "),s("el-form-item",{attrs:{label:"站点：",prop:"site"}},[s("el-select",{attrs:{placeholder:"请选择",size:"small"},model:{value:t.dgForm.site,callback:function(e){t.$set(t.dgForm,"site",e)},expression:"dgForm.site"}},t._l(t.stockSiteList,function(t,e){return s("el-option",{key:e,attrs:{label:t,value:t}})}),1)],1),t._v(" "),s("el-form-item",{attrs:{label:"月份：",prop:"select_month"}},[s("el-date-picker",{attrs:{type:"month",placeholder:"选择日期",format:"yyyy-MM","value-format":"yyyy-MM",size:"small","picker-options":t.monthPickerOptions},model:{value:t.dgForm.select_month,callback:function(e){t.$set(t.dgForm,"select_month",e)},expression:"dgForm.select_month"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"选择文件："}},[s("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:"123","before-upload":t.uploadDealGatherSettle,"http-request":t.uploadFile,"on-success":t.uploadSuccess,"on-remove":t.handleRemove,limit:1}},[s("el-button",{attrs:{size:"small",type:"primary"}},[t._v("选择文件")])],1)],1)],1),t._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(e){t.dealAndGatherVisible=!1}}},[t._v("取 消")]),t._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:t.uploadDealAndGather}},[t._v("确 定")])],1)],1),t._v(" "),s("el-dialog",{attrs:{visible:t.settleVisible,width:"30%",center:"","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(e){t.settleVisible=e},close:t.settleDialogClose}},[s("el-form",{ref:"settleRef",staticClass:"demo-ruleForm",attrs:{model:t.settleForm,rules:t.formRules,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"渠道：",prop:"platform"}},[s("el-select",{attrs:{placeholder:"请选择",size:"small"},model:{value:t.settleForm.platform,callback:function(e){t.$set(t.settleForm,"platform",e)},expression:"settleForm.platform"}},t._l(t.platformList,function(t,e){return s("el-option",{key:e,attrs:{label:t,value:t}})}),1)],1),t._v(" "),s("el-form-item",{attrs:{label:"国家：",prop:"country"}},[s("el-select",{attrs:{placeholder:"请选择",size:"small"},on:{change:t.countrySelectChange},model:{value:t.settleForm.country,callback:function(e){t.$set(t.settleForm,"country",e)},expression:"settleForm.country"}},t._l(t.stockCountryList,function(t,e){return s("el-option",{key:e,attrs:{label:t,value:t}})}),1)],1),t._v(" "),s("el-form-item",{attrs:{label:"站点：",prop:"site"}},[s("el-select",{attrs:{placeholder:"请选择",size:"small"},model:{value:t.settleForm.site,callback:function(e){t.$set(t.settleForm,"site",e)},expression:"settleForm.site"}},t._l(t.stockSiteList,function(t,e){return s("el-option",{key:e,attrs:{label:t,value:t}})}),1)],1),t._v(" "),s("el-form-item",{attrs:{label:"时间：",prop:"daterange"}},[s("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd","picker-options":t.pickerOptions},model:{value:t.settleForm.daterange,callback:function(e){t.$set(t.settleForm,"daterange",e)},expression:"settleForm.daterange"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"选择文件："}},[s("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:"123","before-upload":t.uploadDealGatherSettle,"http-request":t.uploadFile,"on-success":t.uploadSuccess,"on-remove":t.handleRemove,limit:1}},[s("el-button",{attrs:{size:"small",type:"primary"}},[t._v("选择文件")])],1)],1)],1),t._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(e){t.settleVisible=!1}}},[t._v("取 消")]),t._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:t.uploadDealAndGather}},[t._v("确 定")])],1)],1),t._v(" "),s("el-dialog",{attrs:{visible:t.returnReportVisible,width:"30%",center:"","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(e){t.returnReportVisible=e},close:t.rpDialogClose}},[s("el-form",{ref:"rpForm",staticClass:"demo-ruleForm",attrs:{model:t.rpForm,rules:t.formRules,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"渠道：",prop:"platform"}},[s("el-select",{attrs:{placeholder:"请选择",size:"small"},model:{value:t.rpForm.platform,callback:function(e){t.$set(t.rpForm,"platform",e)},expression:"rpForm.platform"}},t._l(t.platformList,function(t,e){return s("el-option",{key:e,attrs:{label:t,value:t}})}),1)],1),t._v(" "),s("el-form-item",{attrs:{label:"国家：",prop:"country"}},[s("el-select",{attrs:{placeholder:"请选择",size:"small"},on:{change:t.countrySelectChange},model:{value:t.rpForm.country,callback:function(e){t.$set(t.rpForm,"country",e)},expression:"rpForm.country"}},t._l(t.stockCountryList,function(t,e){return s("el-option",{key:e,attrs:{label:t,value:t}})}),1)],1),t._v(" "),s("el-form-item",{attrs:{label:"站点：",prop:"site"}},[s("el-select",{attrs:{placeholder:"请选择",size:"small"},model:{value:t.rpForm.site,callback:function(e){t.$set(t.rpForm,"site",e)},expression:"rpForm.site"}},t._l(t.stockSiteList,function(t,e){return s("el-option",{key:e,attrs:{label:t,value:t}})}),1)],1),t._v(" "),s("el-form-item",{attrs:{label:"月份：",prop:"select_month"}},[s("el-date-picker",{attrs:{type:"month",placeholder:"选择日期",format:"yyyy-MM","value-format":"yyyy-MM",size:"small","picker-options":t.monthPickerOptions},model:{value:t.rpForm.select_month,callback:function(e){t.$set(t.rpForm,"select_month",e)},expression:"rpForm.select_month"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"选择文件："}},[s("el-upload",{ref:"uploadRp",staticClass:"upload-demo",attrs:{action:"123","file-list":t.returnFile,limit:1,"before-upload":t.beforeUploadRp,"http-request":t.uploadFileRp,"on-success":t.uploadSuccessRp,"on-remove":t.handleRemoveRp,accept:"text/plain"}},[s("el-button",{attrs:{size:"small",type:"primary"}},[t._v("选择文件")])],1)],1)],1),t._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:t.rpDialogClose}},[t._v("取 消")]),t._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.uploadReturnRp("rpForm")}}},[t._v("确 定")])],1)],1),t._v(" "),t.isReturnReport?s("div",{staticClass:"all-select"},[s("div",{staticClass:"select"},[s("span",[t._v("渠道:")]),t._v(" "),s("el-select",{attrs:{placeholder:"请选择",size:"small"},model:{value:t.selection.platform,callback:function(e){t.$set(t.selection,"platform",e)},expression:"selection.platform"}},t._l(t.platformList,function(t,e){return s("el-option",{key:e,attrs:{label:t,value:t}})}),1)],1),t._v(" "),s("div",{staticClass:"select"},[s("span",[t._v("国家:")]),t._v(" "),s("el-select",{attrs:{placeholder:"请选择",size:"small"},on:{change:t.countrySelectChange},model:{value:t.selection.country,callback:function(e){t.$set(t.selection,"country",e)},expression:"selection.country"}},t._l(t.stockCountryList,function(t,e){return s("el-option",{key:e,attrs:{label:t,value:t}})}),1)],1),t._v(" "),s("div",{staticClass:"select"},[s("span",[t._v("站点:")]),t._v(" "),s("el-select",{attrs:{placeholder:"请选择",size:"small"},model:{value:t.selection.site,callback:function(e){t.$set(t.selection,"site",e)},expression:"selection.site"}},t._l(t.stockSiteList,function(t,e){return s("el-option",{key:e,attrs:{label:t,value:t}})}),1)],1),t._v(" "),s("div",{staticClass:"select month"},[s("span",[t._v("月份：")]),t._v(" "),s("el-date-picker",{attrs:{type:"month",placeholder:"选择日期",format:"yyyy-MM","value-format":"yyyy-MM",size:"small","picker-options":t.monthPickerOptions},model:{value:t.selection.select_month,callback:function(e){t.$set(t.selection,"select_month",e)},expression:"selection.select_month"}}),t._v(" "),s("el-button",{staticStyle:{"margin-left":"6px"},attrs:{type:"primary",size:"mini"},on:{click:t.getReturnReport}},[t._v("生成")])],1)]):t._e()],1)},staticRenderFns:[]};var i=s("VU/8")(l,o,!1,function(t){s("YPIS")},"data-v-43c6c102",null).exports,a={name:"",props:{orderList:{type:Array,default:function(){return[]}},type:{type:String},selectOpt:{type:Object}},components:{},data:function(){return{}},computed:{orderListLength:function(){return this.orderList.length},url:function(){return this.orderList[0].url}},watch:{},methods:{},created:function(){},mounted:function(){}},r={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"order-list"},[s("el-table",{staticStyle:{width:"96%"},attrs:{data:t.orderList,border:"",height:t.orderListLength>6?336:null,stripe:""}},[s("el-table-column",{attrs:{type:"index",width:"50",label:"序号"}}),t._v(" "),s("el-table-column",{attrs:{prop:"channel",label:"渠道"}}),t._v(" "),s("el-table-column",{attrs:{prop:"store",label:"站点"}}),t._v(" "),s("el-table-column",{attrs:{prop:"country",label:"国家"}}),t._v(" "),s("el-table-column",{attrs:{prop:"date",label:"时间"}}),t._v(" "),s("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("a",{staticClass:"download",attrs:{href:t._url3+"order_report_download/?file_path="+t.url,download:e.row.file_name}},[t._v("下载")])]}}])})],1)],1)},staticRenderFns:[]};var n=s("VU/8")(a,r,!1,function(t){s("VB45")},"data-v-7f40d6da",null).exports,c={name:"",props:{vatList:{type:Array,default:function(){return[]}}},components:{},data:function(){return{}},computed:{},watch:{},methods:{downloadUrlFile:function(t){var e=this;t=t.replace(/\\/g,"/");var s=new XMLHttpRequest;s.open("GET",t,!0),s.responseType="blob",s.onload=function(){if(200===s.status){var l=e.getFileName(t);e.saveAs(s.response,l)}},s.send()},saveAs:function(t,e){var s=window.URL||window.webkitURL||window,l=new Blob([t]),o=document.createElementNS("http://www.w3.org/1999/xhtml","a");o.href=s.createObjectURL(l),o.download=e,o.click()},getFileName:function(t){var e=t.lastIndexOf("/")+1,s=t.substring(e);return s=decodeURI(s.split("?")[0])}},created:function(){},mounted:function(){}},p={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("el-table",{staticStyle:{width:"46%"},attrs:{data:t.vatList,border:"",stripe:""}},[s("el-table-column",{attrs:{type:"index",width:"50",label:"序号"}}),t._v(" "),s("el-table-column",{attrs:{prop:"month",label:"月份"}}),t._v(" "),s("el-table-column",{attrs:{prop:"fileName",label:"报告"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("a",{attrs:{href:"https://www.beyoung.group/file_download/?path=operation/VAT_report/"+e.row.month.replace(/-/,"_")+"/&filename="+e.row.fileName,download:e.row.fileName}},[t._v(t._s(e.row.fileName))])]}}])})],1)],1)},staticRenderFns:[]};var u=s("VU/8")(c,p,!1,function(t){s("5K7/")},"data-v-fc6dff06",null).exports,d={name:"",props:{stockList:{type:Array,default:function(){return[]}}},components:{},data:function(){return{file:""}},computed:{stockListLength:function(){return this.stockList.length}},watch:{},methods:{},created:function(){},mounted:function(){}},m={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"stock-list"},[s("el-table",{staticStyle:{width:"96%"},attrs:{data:t.stockList,border:""}},[s("el-table-column",{attrs:{type:"index",width:"50",label:"序号"}}),t._v(" "),s("el-table-column",{attrs:{prop:"0",label:"渠道"}}),t._v(" "),s("el-table-column",{attrs:{prop:"1",label:"站点"}}),t._v(" "),s("el-table-column",{attrs:{prop:"2",label:"国家"}}),t._v(" "),s("el-table-column",{attrs:{prop:"3",label:"时间"}}),t._v(" "),s("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("a",{attrs:{href:t._urlzgl+e.row[4]}},[t._v("下载")])]}}])})],1)],1)},staticRenderFns:[]};var h=s("VU/8")(d,m,!1,function(t){s("NdXR")},"data-v-c9d14036",null).exports,f={name:"",props:{orderList:{type:Array,default:function(){return[]}}},components:{},data:function(){return{}},computed:{orderListLength:function(){return this.orderList.length},isType:function(){if(this.orderList.length>0)return"交易报告"==this.orderList[0][7]||"汇总报告"==this.orderList[0][7]}},watch:{},methods:{},created:function(){},mounted:function(){}},v={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"order-list"},[s("el-table",{staticStyle:{width:"96%"},attrs:{data:t.orderList,border:"",height:t.orderListLength>6?336:null,stripe:""}},[s("el-table-column",{attrs:{type:"index",width:"50",label:"序号"}}),t._v(" "),s("el-table-column",{attrs:{prop:"1",label:"渠道"}}),t._v(" "),s("el-table-column",{attrs:{prop:"2",label:"站点"}}),t._v(" "),s("el-table-column",{attrs:{prop:"3",label:"国家"}}),t._v(" "),t.isType?s("el-table-column",{attrs:{prop:"4",label:"时间"}}):t._e(),t._v(" "),t.isType?t._e():s("el-table-column",{attrs:{prop:"5",label:"起始时间"}}),t._v(" "),t.isType?t._e():s("el-table-column",{attrs:{prop:"6",label:"结束时间"}}),t._v(" "),s("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("a",{attrs:{download:e.row[8],href:"https://www.beyoung.group/file_download/?path="+e.row[8].slice(0,e.row[8].lastIndexOf("/"))+"/&filename="+e.row[8].slice(e.row[8].lastIndexOf("/")+1)}},[t._v("下载")])]}}])})],1)],1)},staticRenderFns:[]};var _=s("VU/8")(f,v,!1,function(t){s("WnNj")},"data-v-6a809886",null).exports,y={data:function(){return{}},props:{return_list:{type:Array,default:function(){return[]}}},computed:{},created:function(){console.log(this.return_list)}},g={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"return_list"}},[s("el-table",{staticStyle:{width:"96%"},attrs:{data:t.return_list,border:"",stripe:""}},[s("el-table-column",{attrs:{type:"index",width:"50",label:"序号"}}),t._v(" "),s("el-table-column",{attrs:{prop:"platform",label:"渠道"}}),t._v(" "),s("el-table-column",{attrs:{prop:"site",label:"站点"}}),t._v(" "),s("el-table-column",{attrs:{prop:"country",label:"国家"}}),t._v(" "),s("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("a",{attrs:{download:e.row.file_path,href:"https://www.beyoung.group/file_download/?path="+e.row.file_path.slice(0,e.row.file_path.lastIndexOf("/"))+"/&filename="+e.row.file_path.slice(e.row.file_path.lastIndexOf("/")+1)}},[t._v("下载")])]}}])})],1)],1)},staticRenderFns:[]};var b={name:"",props:{},components:{SortSelection:i,OrderList:n,VatList:u,StockList:h,OrderListTwo:_,ReturnList:s("VU/8")(y,g,!1,function(t){s("vpkM")},null,null).exports},data:function(){return{selectOpt:{},title:"所有订单报告",type:"report",orderList:[],fileName:[],monthList:[],downloadPath:[],vatList:[],stockPath:"",stockList:[],dgsList:[],return_list:[]}},computed:{isVatReport:function(){return"VAT报告"===this.title},isStockReport:function(){return"库存报告"===this.title},isDealAndGatherReport:function(){return"交易报告"===this.title||"汇总报告"===this.title||"结算周期报告"===this.title},isReturn:function(){return"退货报告"===this.title||"退款报告"===this.title}},watch:{},methods:{dispatchReturn:function(t){this.return_list=t||[]},menuClick:function(t){var e=this;switch(console.log(t.target.innerText),t.target.innerText){case"所有订单报告":this.title="所有订单报告",this.type="report";break;case"已完成订单报告":this.title="已完成订单报告",this.type="completed_report";break;case"交易报告":this.title="交易报告";break;case"汇总报告":this.title="汇总报告";break;case"结算周期报告":this.title="结算周期报告";break;case"库存报告":this.title="库存报告",this.stockList=[];break;case"VAT报告":this.vatList=[],this.title="VAT报告",this.$api.getVatList().then(function(t){for(var s in console.log(t),e.fileName=t.data.ret_files_name_list,e.monthList=t.data.month_list,e.monthList){var l=e.fileName[s];for(var o in l){var i={};i.fileName=l[o],i.month=e.monthList[s],e.vatList.push(i)}}e.$forceUpdate(),console.log(e.vatList)});break;case"退货报告":this.title="退货报告",this.return_list=[];break;case"退款报告":this.title="退款报告",this.return_list=[]}if("订单"!==t.target.innerText){var s=this.$refs.selection.selection;for(var l in s)s[l]="";for(var o in this.$refs.selection.stockSelection)this.$refs.selection.stockSelection[o]="";this.$refs.selection.stockSelection.type="库存报告",this.$refs.selection.isDateDisabled=!1,this.$refs.selection.isMonthDisabled=!1,this.$refs.selection.isStockDateDisabled=!1,this.$refs.selection.isStockMonthDisabled=!1,this.$refs.selection.siteList=[],this.$refs.selection.stockSiteList=[],this.orderList=[],this.dgsList=[],this.stockList=[]}},createReport:function(t,e){console.log(t),this.orderList=t,this.selectOpt=e},getVatReport:function(t,e){console.log(t),console.log(e)},queryVatReport:function(t){var e=this;console.log("asdsasdsa"),this.vatList=[],this.$api.getVatList(t).then(function(t){if(console.log(t),t){for(var s in e.fileName=t.data.ret_files_name_list,e.monthList=t.data.month_list,e.monthList){var l=e.fileName[s];for(var o in l){var i={};i.fileName=l[o],i.month=e.monthList[s],e.vatList.push(i)}}e.$forceUpdate(),console.log(e.vatList)}})},refresh:function(){var t=this;this.$api.getVatList().then(function(e){if(t.vatList=[],console.log(e),e){for(var s in t.fileName=e.data.ret_files_name_list,t.monthList=e.data.month_list,t.monthList){var l=t.fileName[s];for(var o in l){var i={};i.fileName=l[o],i.month=t.monthList[s],t.vatList.push(i)}}t.$forceUpdate(),console.log(t.vatList)}})},getStockReport:function(t,e){this.stockList=[],this.stockPath=t;var s=[];""!==e.date?s.push(e.platform,e.site,e.country,e.date,t):s.push(e.platform,e.site,e.country,e.month,t),this.stockList.push(s)},getDealGatherSettleList:function(t){this.dgsList=t}},created:function(){},mounted:function(){}},k={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"settle-report"}},[s("div",{staticClass:"left"},[s("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{"default-active":"1-1"},nativeOn:{click:function(e){return t.menuClick(e)}}},[s("el-submenu",{attrs:{index:"1"}},[s("template",{slot:"title"},[s("span",[t._v("订单")])]),t._v(" "),s("el-menu-item",{attrs:{index:"1-1"}},[s("span",{attrs:{slot:"title"},slot:"title"},[t._v("所有订单报告")])]),t._v(" "),s("el-menu-item",{attrs:{index:"1-2"}},[s("span",{attrs:{slot:"title"},slot:"title"},[t._v("已完成订单报告")])])],2),t._v(" "),s("el-menu-item",{attrs:{index:"2"}},[s("span",{attrs:{slot:"title"},slot:"title"},[t._v("交易报告")])]),t._v(" "),s("el-menu-item",{attrs:{index:"3"}},[s("span",{attrs:{slot:"title"},slot:"title"},[t._v("汇总报告")])]),t._v(" "),s("el-menu-item",{attrs:{index:"4"}},[s("span",{attrs:{slot:"title"},slot:"title"},[t._v("结算周期报告")])]),t._v(" "),s("el-menu-item",{attrs:{index:"5"}},[s("span",{attrs:{slot:"title"},slot:"title"},[t._v("库存报告")])]),t._v(" "),s("el-menu-item",{attrs:{index:"6"}},[s("span",{attrs:{slot:"title"},slot:"title"},[t._v("VAT报告")])]),t._v(" "),s("el-menu-item",{attrs:{index:"7"}},[s("span",{attrs:{slot:"title"},slot:"title"},[t._v("退货报告")])]),t._v(" "),s("el-menu-item",{attrs:{index:"8"}},[s("span",{attrs:{slot:"title"},slot:"title"},[t._v("退款报告")])])],1)],1),t._v(" "),s("div",{staticClass:"right"},[s("sort-selection",{ref:"selection",attrs:{title:t.title,type:t.type},on:{createReport:t.createReport,getVatReport:t.getVatReport,queryVatReport:t.queryVatReport,getStockReport:t.getStockReport,getDealGatherSettleList:t.getDealGatherSettleList,refresh:t.refresh,getReturnData:t.dispatchReturn}}),t._v(" "),t.orderList.length>0?s("order-list",{attrs:{selectOpt:t.selectOpt,type:t.type,orderList:t.orderList}}):t._e(),t._v(" "),t.isVatReport?s("vat-list",{ref:"vat",attrs:{vatList:t.vatList}}):t._e(),t._v(" "),t.isStockReport&&t.stockList.length>0?s("stock-list",{ref:"stock",attrs:{stockList:t.stockList}}):t._e(),t._v(" "),t.isDealAndGatherReport&&t.dgsList.length>0?s("order-list-two",{attrs:{orderList:t.dgsList}}):t._e(),t._v(" "),t.isReturn&&t.return_list.length>0?s("return-list",{attrs:{return_list:t.return_list}}):t._e()],1)])},staticRenderFns:[]};var L=s("VU/8")(b,k,!1,function(t){s("JLRG")},"data-v-a9c94e86",null);e.default=L.exports},NdXR:function(t,e){},VB45:function(t,e){},WnNj:function(t,e){},YPIS:function(t,e){},vpkM:function(t,e){}});
//# sourceMappingURL=6.8a84c2e3ccd94dd734cd.js.map