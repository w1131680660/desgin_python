webpackJsonp([96],{"2zz3":function(t,e){},EV1k:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});a("mtWM");var s={data:function(){return{listdata:[],listArr:[],initData:[],flag:"密码登录",username:"",password:"",login_state:"",login_dialog:!0}},computed:{stateYear:function(){return this.$store.state.status}},watch:{stateYear:{handler:function(t){var e=this;this.$nextTick(function(){e.login_state=t})}},immediate:!0},mounted:function(){this.if_login()},methods:{toUpdatePage:function(){this.$router.push({path:"/SysUpdateLog"})},submit_login:function(){var t=this,e=this,a=new FormData;a.append("user",this.username),a.append("pwd",this.password),console.log(this.username),console.log(this.password),console.log(a),this.$axios.post(e._url2+"server/personnel_management/login/",a).then(function(a){if(console.log(a),200===a.data.code){console.log(a.data);var s=a.data.token;sessionStorage.setItem("token",s),sessionStorage.setItem("area",a.data.area),sessionStorage.setItem("user_name",a.data.user_name),sessionStorage.setItem("PERMISSION_SESSION_KEY",a.data.PERMISSION_SESSION_KEY),e.login_state="已登录",e.$store.state.status="已登录",e.login_dialog=!1,t.getLastWeekData()}else alert("密码或用户名错误"),e.login_state="登录",e.$store.state.status="登录"})},getLastWeekData:function(){var t=this,e=this._url2+"server/personnel_management/select_system_update_log/";this.$axios.get(e,{params:{update_area:"",data_date:""}}).then(function(e){if(200===e.data.code){t.initData=e.data.data||[];var a=(new Date).getTime()-6048e5;console.log(a,new Date(a)),t.initData.forEach(function(e,s){console.log(new Date(e.update_time),new Date(e.update_time).getTime());var i=new Date(e.update_time).getTime();if(i<a)console.log(i,a,"不在一周内");else{console.log(i,a,"在一周内");var n=t.listArr.indexOf(e.update_time);if(n>-1)t.listdata[n].value.push(e.update_info);else{t.listArr.push(e.update_time);var o={};o.time=e.update_time,o.value=[],o.value.push(e.update_info),t.listdata.push(o)}}}),t.listdata=t.listdata.sort(function(t,e){return console.log(new Date(e.time).getTime(),new Date(t.time).getTime()),new Date(e.time).getTime()-new Date(t.time).getTime()}),console.log(t.listdata,t.listArr)}})},if_login:function(){"已登录"==this.$store.state.status?(this.login_dialog=!1,this.getLastWeekData()):this.login_dialog=!0},idEnter:function(){document.querySelector(".passwordInupt").focus()}}},i={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"boxed_wrapper"},[t.login_dialog?a("div",{staticClass:"login_dialog"},[a("div",{staticClass:"login_views"},[a("span",{staticClass:"passwork_login",class:["密码登录"==t.flag?"bottom_line":""],on:{click:function(e){t.flag="密码登录"}}},[t._v("密码登录")]),t._v(" "),"找回密码"==t.flag?a("span",{staticClass:"unpasswork_login",class:["找回密码"==t.flag?"bottom_line":""]},[t._v("找回密码")]):t._e(),t._v(" "),"密码登录"==t.flag?a("div",{staticClass:"passwork_login_view"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.username,expression:"username"}],attrs:{type:"text",placeholder:"账号"},domProps:{value:t.username},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.idEnter()},input:function(e){e.target.composing||(t.username=e.target.value)}}}),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],staticClass:"passwordInupt",attrs:{type:"password",placeholder:"密码"},domProps:{value:t.password},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.submit_login(e)},input:function(e){e.target.composing||(t.password=e.target.value)}}}),t._v(" "),a("a",{staticClass:"submit_passwork",attrs:{href:"javascript:;"},on:{click:t.submit_login}},[t._v("登录")])]):t._e()])]):t._e(),t._v(" "),t.login_dialog?t._e():a("div",{staticClass:"sysUpdateNotify"},[a("h2",[a("i",{staticClass:"el-icon-message"}),t._v("系统近一周更新\n      "),a("span",{staticClass:"toHistory",on:{click:t.toUpdatePage}},[t._v("历史记录")])]),t._v(" "),a("div",{staticClass:"notifyContent"},[a("ul",[t._l(t.listArr,function(e,s){return a("li",{key:s},[t._v("\n          "+t._s(t.listdata[s].time)+"\n          "),a("ul",{staticClass:"updateLiDetail"},t._l(t.listdata[s].value,function(e,s){return a("li",{key:s},[t._v("\n              "+t._s(e)+"\n            ")])}),0)])}),t._v(" "),t.listArr.length?t._e():a("li",[t._v("暂无数据")])],2)])])])},staticRenderFns:[]};var n=a("VU/8")(s,i,!1,function(t){a("2zz3")},"data-v-1f297008",null);e.default=n.exports}});
//# sourceMappingURL=96.dec6c3ce2d8ee2eb3309.js.map