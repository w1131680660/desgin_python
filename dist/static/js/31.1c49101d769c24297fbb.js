webpackJsonp([31],{bpx0:function(e,t){},cP1Y:function(e,t){},iHBg:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o("BO1k"),r=o.n(i),a={name:"",props:{},components:{},data:function(){return{loading:!1,list:["a","b","c","d"],menuPlatFormList:[],menuCountryList:[],menuSiteList:[],showCountryList:[],showSiteList:[],lastSiteList:[],mailList:[],checkedPlatform:"",checkedCountry:"",checkedSite:"",checkedProType:"VAT",proTypeList:[],checkProTypeList:[],auditProTypeList:[],auditKeyWordList:[],formRules:{proName:[{required:!0,message:"请输入问题类型",trigger:"blur"}],deleteProName:[{required:!0,message:"请选择问题类型",trigger:"change"}],keyWordProName:[{required:!0,message:"请选择问题类型",trigger:"change"}]},addProTypeDialogVisible:!1,addProTypeForm:{proName:""},deleteProTypeDialogVisible:!1,deleteProTypeForm:{deleteProName:[]},keywordDialogVisible:!1,keyWordForm:{keyWordProName:"",newKeyWord:""},keywordList:[],isShowNewKeyWord:!1,addInputList:[],auditDialogVisible:!1,auditAdd:{checkedProType:""},isShowKeyWord:!1,isShowProType:!1,currentPage:1,total:0,pageSize:50}},computed:{},watch:{},methods:{getMenuList:function(){var e=this;this.$api.getMenuList().then(function(t){e.menuPlatFormList=t.data.data1,e.menuCountryList=t.data.data2,e.menuSiteList=t.data.data3,e.showCountryList=e.menuCountryList[0],e.showSiteList=e.menuSiteList[0],e.lastSiteList=e.showSiteList[0],e.checkedPlatform=e.menuPlatFormList[0],e.checkedCountry=e.showCountryList[0],e.checkedSite=e.lastSiteList[0],e.thirdClick(e.checkedPlatform,e.checkedCountry,e.checkedSite)})},getProTypeList:function(){var e=this;this.$api.proTypeList().then(function(t){console.log(t),e.proTypeList=e.$utils.deepClone(t.data.data);for(var o=0;o<e.proTypeList.length;o++)for(var i=o+1;i<e.proTypeList.length;i++)e.proTypeList[o][0]===e.proTypeList[i][0]&&(e.proTypeList.splice(i,1),i--);console.log("aaaa",e.proTypeList)})},getCheckProTypeList:function(){var e=this;this.$api.getCheckProTypeList().then(function(t){e.checkProTypeList=t.data.data})},getAuditTypeList:function(){var e=this;this.$api.getAuditTypeList().then(function(t){e.auditProTypeList=t.data.type_list,e.auditKeyWordList=t.data.keyword_list})},onceClick:function(e){this.showCountryList=[],this.showSiteList=[],this.showCountryList=this.menuCountryList[e],this.showSiteList=this.menuSiteList[e]},secondClick:function(e){this.lastSiteList=[],this.lastSiteList=this.showSiteList[e]},thirdClick:function(e,t,o){var i=this;this.loading=!0,this.checkedPlatform=e,this.checkedCountry=t,this.checkedSite=o,this.checkedProType="VAT";this.$api.queryMail(this.checkedPlatform,this.checkedCountry,this.checkedSite,this.checkedProType,1).then(function(e){console.log(e),i.mailList=e.data.data,i.total=e.data.all_number,i.$nextTick(function(){i.$refs.VMTable.bodyWrapper.scrollTop=0}),i.currentPage=1,i.loading=!1})},proTypeChange:function(e){var t=this;this.loading=!0,this.checkedProType=e;this.$api.queryMail(this.checkedPlatform,this.checkedCountry,this.checkedSite,this.checkedProType,1).then(function(e){t.mailList=e.data.data,t.total=e.data.all_number,t.$nextTick(function(){t.$refs.VMTable.bodyWrapper.scrollTop=0}),t.currentPage=1,t.loading=!1})},selectChange:function(e){console.log(e)},addProType:function(){var e=this;this.$nextTick(function(){e.addProTypeDialogVisible=!0})},addProTypeClose:function(){this.$refs.addProRef.resetFields()},addProTypeConfirm:function(){var e=this;this.$refs.addProRef.validate(function(t){if(t){var o=new FormData;o.append("alert_type",e.addProTypeForm.proName),e.$api.addProType(o).then(function(t){4041!==t.data.code?(e.$message.success("新增成功,等待主管审核"),e.addProTypeDialogVisible=!1,e.getAuditTypeList()):e.$message.warning(t.data.msg)})}})},deletePorType:function(){this.deleteProTypeDialogVisible=!0},deleteProTypeClose:function(){this.$refs.deleteProRef.resetFields()},deleteProTypeConfirm:function(){var e=this;this.$refs.deleteProRef.validate(function(t){if(t){for(var o in console.log("删除的列表",e.deleteProTypeForm.deleteProName),console.log("删除的数据",e.auditProTypeList),e.deleteProTypeForm.deleteProName){var i=e.deleteProTypeForm.deleteProName[o],r=[];r.push(i),r.push("删除类型待审核"),e.auditProTypeList.push(r)}console.log("删除的数据",e.auditProTypeList),e.$api.deleteProType(e.deleteProTypeForm.deleteProName).then(function(t){e.$message("删除成功，等待主管审核"),e.checkedProType=e.proTypeList.length>0?e.proTypeList[0][0]:"",e.deleteProTypeDialogVisible=!1})}})},keyword:function(){this.keywordDialogVisible=!0},keywordClose:function(){this.$refs.keyWordRef.resetFields(),this.isShowNewKeyWord=!1,this.addInputList=[],this.keywordList=[]},keyWordConfirm:function(){var e=this;this.$refs.keyWordRef.validate(function(t){if(t&&(1!==e.keywordList.length||null!==e.keywordList[0][0]||0!==e.addInputList.length)){console.log(e.keywordList),console.log(e.addInputList);var o=new FormData;o.append("alert_type",e.keyWordForm.keyWordProName);var i=!0,a=!1,l=void 0;try{for(var s,n=r()(e.keywordList);!(i=(s=n.next()).done);i=!0){var d=s.value;o.append("keyword_list",d[0])}}catch(e){a=!0,l=e}finally{try{!i&&n.return&&n.return()}finally{if(a)throw l}}var c=!0,p=!1,u=void 0;try{for(var y,h=r()(e.addInputList);!(c=(y=h.next()).done);c=!0){var f=y.value;""!=f&&o.append("keyword_list",f)}}catch(e){p=!0,u=e}finally{try{!c&&h.return&&h.return()}finally{if(p)throw u}}e.$api.editKeyWord(o).then(function(t){console.log(t),e.$message.success("修改关键词成功,等待管理员审核"),e.getAuditTypeList(),e.keywordDialogVisible=!1})}})},removeOneKeyWord:function(e){if(1!==this.keywordList.length){for(var t in this.keywordList)t==e&&this.keywordList.splice(t,1);console.log(this.keywordList)}},addNewKeyWord:function(){this.addInputList.length;for(var e in this.keywordList){if(null===this.keywordList[e][0])return}this.isShowNewKeyWord=!0;this.keywordList.push([null]),console.log(this.keywordList)},proNameChange:function(e){var t=this;this.$api.getKeyWord(e).then(function(e){console.log(e),t.keywordList=e.data.data,console.log("获取的数据",t.keywordList),t.keywordList.length>1&&null===t.keywordList[0][0]&&(t.keywordList.shift(),console.log(t.keywordList))}),this.addInputList=[]},audit:function(){this.auditDialogVisible=!0},auditClose:function(){this.isShowProType=!1,this.isShowKeyWord=!1},proTypeAdopt:function(e,t){var o=this;this.$api.audit(e,"",t).then(function(e){o.$message.success("审核成功"),o.getAuditTypeList(),o.getProTypeList(),o.getCheckProTypeList()})},keyWordAdopt:function(e,t,o){var i=this;this.$api.audit(e,t,o).then(function(e){i.$message.success("审核成功"),i.getAuditTypeList()})},handleCurrentChange:function(e){var t=this;this.loading=!0,console.log(e),this.$api.queryMail(this.checkedPlatform,this.checkedCountry,this.checkedSite,this.checkedProType,e).then(function(e){t.mailList=e.data.data,t.total=e.data.all_number,t.$nextTick(function(){t.$refs.VMTable.bodyWrapper.scrollTop=0}),t.loading=!1})},indexMethods:function(e){return 50*(this.currentPage-1)+(e+1)}},created:function(){this.getMenuList(),this.getProTypeList(),this.getCheckProTypeList(),this.getAuditTypeList()},mounted:function(){}},l={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{attrs:{id:"ipi-board"}},[o("div",{staticClass:"left"},[e._m(0),e._v(" "),o("div",{staticClass:"left-content"},[o("h3",[e._v("请选择店铺")]),e._v(" "),o("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{"default-active":"0-0-0","unique-opened":""}},e._l(e.menuPlatFormList,function(t,i){return o("el-submenu",{key:i,attrs:{index:i+""}},[o("template",{slot:"title"},[o("span",{staticStyle:{display:"inline-block",width:"100%"},on:{click:function(t){return e.onceClick(i)}}},[e._v(e._s(t))])]),e._v(" "),e._l(e.showCountryList,function(r,a){return o("el-submenu",{key:a,attrs:{index:i+"-"+a}},[o("template",{slot:"title"},[o("span",{staticStyle:{display:"inline-block",width:"100%"},on:{click:function(t){return e.secondClick(a)}}},[e._v(e._s(r))])]),e._v(" "),e._l(e.lastSiteList,function(l,s){return o("el-menu-item",{key:s,attrs:{index:i+"-"+a+"-"+s},on:{click:function(o){return e.thirdClick(t,r,l)}}},[o("span",[e._v(e._s(l))])])})],2)})],2)}),1)],1)]),e._v(" "),o("div",{staticClass:"right"},[o("div",{staticClass:"select"},[o("span",[e._v("按问题类型筛选")]),e._v(" "),o("el-select",{attrs:{placeholder:"请选择"},on:{change:e.proTypeChange},model:{value:e.checkedProType,callback:function(t){e.checkedProType=t},expression:"checkedProType"}},e._l(e.proTypeList,function(e,t){return o("el-option",{key:t,attrs:{label:e[0],value:e[0]}})}),1),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:e.addProType}},[e._v("新增问题类型")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:e.deletePorType}},[e._v("删除问题类型")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:e.keyword}},[e._v("关键词")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:e.audit}},[e._v("问题类型审核")])],1),e._v(" "),o("div",{staticClass:"table"},[o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"VMTable",staticStyle:{width:"96%",margin:"0 auto"},attrs:{data:e.mailList,border:"","max-height":"700","element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"}},[o("el-table-column",{attrs:{type:"index",index:e.indexMethods,width:"80px",label:"序号",align:"center"}}),e._v(" "),o("el-table-column",{attrs:{prop:"4",align:"center",label:"收件邮箱地址",width:"150"}}),e._v(" "),o("el-table-column",{attrs:{width:"350",prop:"5",align:"center",label:"发件人"}}),e._v(" "),o("el-table-column",{attrs:{prop:"6",align:"center",label:"发件时间",width:"150"}}),e._v(" "),o("el-table-column",{attrs:{prop:"7",align:"center",label:"问题类型",width:"100"}}),e._v(" "),o("el-table-column",{attrs:{prop:"8",align:"center",label:"邮件内容"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-popover",{attrs:{placement:"bottom","popper-options":{boundariesElement:"viewport",removeOnDestroy:!0},width:"600",trigger:"click",content:t.row[8]}},[o("p",{staticClass:"mail-content",attrs:{slot:"reference"},slot:"reference"},[e._v("\n                "+e._s(t.row[8])+"\n              ")])])]}}])})],1),e._v(" "),o("el-pagination",{staticStyle:{"text-align":"center","margin-top":"10px"},attrs:{"current-page":e.currentPage,"page-size":e.pageSize,layout:"total,prev, pager, next, jumper",total:e.total},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}})],1)]),e._v(" "),o("el-dialog",{attrs:{title:"新增问题类型",visible:e.addProTypeDialogVisible,width:"30%",center:""},on:{"update:visible":function(t){e.addProTypeDialogVisible=t},close:e.addProTypeClose}},[o("el-form",{ref:"addProRef",attrs:{model:e.addProTypeForm,rules:e.formRules,"label-width":"100px"}},[o("el-form-item",{attrs:{label:"问题类型",prop:"proName"}},[o("el-input",{model:{value:e.addProTypeForm.proName,callback:function(t){e.$set(e.addProTypeForm,"proName",t)},expression:"addProTypeForm.proName"}})],1)],1),e._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.addProTypeDialogVisible=!1}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:e.addProTypeConfirm}},[e._v("确 定")])],1)],1),e._v(" "),o("el-dialog",{attrs:{title:"删除问题类型",visible:e.deleteProTypeDialogVisible,width:"30%",center:""},on:{"update:visible":function(t){e.deleteProTypeDialogVisible=t},close:e.deleteProTypeClose}},[o("el-form",{ref:"deleteProRef",attrs:{model:e.deleteProTypeForm,rules:e.formRules,"label-width":"100px"}},[o("el-form-item",{attrs:{label:"问题类型",prop:"deleteProName"}},[e.checkProTypeList.length>0?o("div",[o("el-checkbox-group",{model:{value:e.deleteProTypeForm.deleteProName,callback:function(t){e.$set(e.deleteProTypeForm,"deleteProName",t)},expression:"deleteProTypeForm.deleteProName"}},e._l(e.checkProTypeList,function(t,i){return o("el-checkbox",{key:i,attrs:{label:t[0]}},[e._v(e._s(t[0]))])}),1)],1):o("div",[e._v("目前暂时没有可以选择的问题类型")])])],1),e._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.deleteProTypeDialogVisible=!1}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:e.deleteProTypeConfirm}},[e._v("确 定")])],1)],1),e._v(" "),o("el-dialog",{attrs:{title:"关键词管理",visible:e.keywordDialogVisible,width:"30%",center:""},on:{"update:visible":function(t){e.keywordDialogVisible=t},close:e.keywordClose}},[o("div",{staticClass:"keyword_dialog"},[o("el-form",{ref:"keyWordRef",attrs:{model:e.keyWordForm,rules:e.formRules,"label-width":"100px"}},[o("el-form-item",{attrs:{label:"问题类型",prop:"keyWordProName"}},[o("el-select",{attrs:{placeholder:"请选择"},on:{change:e.proNameChange},model:{value:e.keyWordForm.keyWordProName,callback:function(t){e.$set(e.keyWordForm,"keyWordProName",t)},expression:"keyWordForm.keyWordProName"}},e._l(e.proTypeList,function(e,t){return o("el-option",{key:t,attrs:{label:e[0],value:e[0]}})}),1)],1)],1),e._v(" "),o("div",{staticClass:"form_body"},[o("el-form",e._l(e.keywordList,function(t,i){return o("el-form-item",{key:i,class:["flex",{notFirst:0!==i}],attrs:{label:0==i?"已有的关键词":"",prop:"haveKeyWord"}},[o("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(t){return e.removeOneKeyWord(i)}}},[e._v("-")]),e._v(" "),o("el-input",{model:{value:t[0],callback:function(o){e.$set(t,0,o)},expression:"item[0]"}}),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.addNewKeyWord}},[e._v("+")])],1)}),1)],1)],1),e._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.keywordDialogVisible=!1}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:e.keyWordConfirm}},[e._v("确 定")])],1)]),e._v(" "),o("el-dialog",{attrs:{visible:e.auditDialogVisible,width:"60%",center:""},on:{"update:visible":function(t){e.auditDialogVisible=t},close:e.auditClose}},[o("el-link",{staticStyle:{"margin-right":"4vw"},attrs:{type:"primary"},on:{click:function(t){e.isShowProType=!0,e.isShowKeyWord=!1}}},[e._v("查看待审核问题类型")]),e._v(" "),o("el-link",{attrs:{type:"primary"},on:{click:function(t){e.isShowKeyWord=!0,e.isShowProType=!1}}},[e._v("查看待审核关键词")]),e._v(" "),o("div",{staticClass:"audit-content"},[e.isShowProType?o("div",{key:"protype",staticClass:"audit-pro-type"},[o("el-table",{staticStyle:{width:"100%"},attrs:{data:e.auditProTypeList}},[o("el-table-column",{attrs:{prop:"0",label:"问题类型"}}),e._v(" "),o("el-table-column",{attrs:{prop:"1",label:"审核类型"}}),e._v(" "),o("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-link",{attrs:{type:"success"},on:{click:function(o){return e.proTypeAdopt(t.row[0],"审核通过")}}},[e._v("审核通过")]),e._v(" "),o("el-link",{attrs:{type:"danger"},on:{click:function(o){return e.proTypeAdopt(t.row[0],"审核不通过")}}},[e._v("审核不通过")])]}}],null,!1,2106814184)})],1)],1):e._e(),e._v(" "),e.isShowKeyWord?o("div",{key:"keyword",staticClass:"audit-keyword"},[o("el-table",{staticStyle:{width:"100%"},attrs:{data:e.auditKeyWordList}},[o("el-table-column",{attrs:{prop:"0",label:"问题类型",fixed:""}}),e._v(" "),o("el-table-column",{attrs:{prop:"1",label:"关键词"}}),e._v(" "),o("el-table-column",{attrs:{prop:"2",label:"审核类型"}}),e._v(" "),o("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-link",{attrs:{type:"success"},on:{click:function(o){return e.keyWordAdopt(t.row[0],t.row[1],"审核通过")}}},[e._v("审核通过")]),e._v(" "),o("el-link",{attrs:{type:"danger"},on:{click:function(o){return e.keyWordAdopt(t.row[0],t.row[1],"审核不通过")}}},[e._v("审核不通过")])]}}],null,!1,560710568)})],1)],1):e._e()])],1)],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"title"},[t("h2",[this._v("邮件预警")])])}]};var s=o("VU/8")(a,l,!1,function(e){o("cP1Y"),o("bpx0")},"data-v-7a9cf43a",null);t.default=s.exports}});
//# sourceMappingURL=31.1c49101d769c24297fbb.js.map