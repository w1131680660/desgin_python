webpackJsonp([30],{hRe6:function(e,t){},lu5b:function(e,t){},zSnw:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("mvHQ"),n=a.n(r),o={computed:{len:function(){return this.tableData.length-1}},data:function(){return{editIdxArr:[],showDetail:!1,priceRate:{GB:{label:"20%",value:.2},other:{label:"18%",value:.18}},descriptArr:["JOISCOPE Desk","HOMEYFINE DESK","JOISCOPE SHOEBOX","HOMEYFINE SHOEBOX","JOISCOPE WARDROBE","HOMEYFIN WARDROBE"],formTop:{order:"",country:""},tableData:[],name:"",address:"",city:"",zip_code:"",Invoice_number:"",dates:"",order_id:"",total:0}},methods:{editSubmit:function(){var e=this;if(0!==this.editIdxArr.length){var t=[];this.editIdxArr.forEach(function(a,r){t.push(e.tableData[a]),console.log(r,t[r]),t[r][5]=e.moneyFlag+t[r][5]});var a=new FormData;a.append("data",n()(t)),a.append("all_price",this.total),a.append("name",this.name),a.append("city",this.city),a.append("address",this.address),a.append("zip_code",this.zip_code),a.append("dates",this.dates),a.append("order_id",this.formTop.order),a.append("Invoice_number",this.Invoice_number);var r=this._url2+"server/order_management/create_invoice_data/";this.$axios.post(r,a).then(function(t){if(200===t.data.code){var a=t.data.data;if(a){a=e.formatUrl(a);var r=document.createElement("a");r.setAttribute("href",e._url2+a),r.setAttribute("download",""),document.body.appendChild(r),r.click()}}else e.$message.warning("请求错误")})}},formatUrl:function(e){return e.replace("/home/by_operate/","")},handleChange:function(e,t){var a=this;if(isNaN(e))this.$set(this.tableData[t],"5","");else{this.editIdxArr.includes(t)||this.editIdxArr.push(t);var r=(Number(e)*(1-this.rate_num)).toFixed(2);r=this.moneyFlag+r,this.$set(this.tableData[t],3,r),this.$set(this.tableData[t],6,this.moneyFlag+Number(this.tableData[t][0])*Number(e));var n=0;if(this.tableData.forEach(function(e,t){console.log(e),t!==a.tableData.length-1&&(n+=Number(e[6].slice(1)))}),n=this.moneyFlag+n,console.log("总计",n),this.tableData.length>0){var o=this.tableData.length-1;this.$set(this.tableData[o],"6",n),this.total=n}console.log(this.tableData[t])}},searchInfo:function(){var e=this;if(""!==this.formTop.order&&""!==this.formTop.station){var t=this._url2+"server/order_management/count_invoice_data/";this.$axios.get(t,{params:{order_id:this.formTop.order,country:this.formTop.country}}).then(function(t){if(console.log(t),200===t.data.code){e.name=t.data.name,e.address=t.data.address,e.city=t.data.city,e.zip_code=t.data.zip_code,e.Invoice_number=t.data.Invoice_number,e.dates=t.data.dates,e.order_id=t.data.order_id,e.showDetail=!0;var a=t.data.data,r="GB"===e.formTop.country?"20%":"18%";for(var n in e.moneyFlag="GB"===e.formTop.country?"£":"€",e.rate_num="20%"===r?.2:.18,e.tableData=[],a){var o=[],i=a[n];for(var l in i)"0"===l&&(o[1]=i[l]),"1"===l&&(o[0]=i[l]);o[2]=e.descriptArr[0],o[3]="0",o[4]=r,o[5]="",o[6]="0",e.tableData.push(o)}e.tableData.push(["","","","","","TOTAL",0])}else e.$message.warning(t.data.msg)})}else this.$message.warning("请输入订单号并选择国家进行查询！")}}},i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"InvoiceFileGeneration"}},[a("div",{staticClass:"topOpt"},[a("el-form",{attrs:{inline:!0,model:e.formTop}},[a("el-form-item",{attrs:{label:"订单号"}},[a("el-input",{attrs:{placeholder:"请输入订单号"},model:{value:e.formTop.order,callback:function(t){e.$set(e.formTop,"order",t)},expression:"formTop.order"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"国家"}},[a("el-select",{attrs:{placeholder:"请选择国家"},model:{value:e.formTop.country,callback:function(t){e.$set(e.formTop,"country",t)},expression:"formTop.country"}},[a("el-option",{attrs:{value:"GB",label:"英国"}}),e._v(" "),a("el-option",{attrs:{value:"other",label:"其他"}})],1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.searchInfo}},[e._v("搜索")])],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.editSubmit}},[e._v("提交")])],1)],1)],1),e._v(" "),e.showDetail?a("div",{staticClass:"dataList"},[a("p",[a("span",[e._v("姓名："),a("i",[e._v(e._s(e.name))])]),e._v(" "),a("span",[e._v("城市："),a("i",[e._v(e._s(e.city))])]),e._v(" "),a("span",[e._v("地址："),a("i",[e._v(e._s(e.address))])]),e._v(" "),a("span",[e._v("邮编："),a("i",[e._v(e._s(e.zip_code))])]),e._v(" "),a("span",[e._v("日期："),a("i",[e._v(e._s(e.dates))])]),e._v(" "),a("span",[e._v("订单号:"),a("i",[e._v(e._s(e.order_id))])]),e._v(" "),a("span",[e._v("发票单号:"),a("i",[e._v(e._s(e.Invoice_number))])])])]):e._e(),e._v(" "),a("div",{staticClass:"tableCon"},[a("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:e.tableData,stripe:""}},[a("el-table-column",{attrs:{align:"center",prop:"0",label:"QTY",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"1",label:"sku",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"2",label:"Item Description",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{model:{value:t.row[2],callback:function(a){e.$set(t.row,2,a)},expression:"scope.row[2]"}},e._l(e.descriptArr,function(e,t){return a("el-option",{key:t,attrs:{value:e,label:e}})}),1)]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"3",label:"Unit Price(excl. VAT)"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"4",label:"VAT Rate"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"5",label:"Unit Price(incl. VAT)"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticStyle:{position:"absolute",top:"50%",left:"35px",transform:"translateY(-50%)"},style:{zIndex:e.len&&t.$index===e.len?-1:1}},[e._v(e._s(e.moneyFlag))]),e._v(" "),a("el-input",{staticStyle:{width:"220px"},attrs:{placeholder:"请输入数字"},on:{change:function(a){e.handleChange(a,t.$index)}},model:{value:t.row[5],callback:function(a){e.$set(t.row,5,a)},expression:"scope.row[5]"}}),e._v(" "),a("div",{staticClass:"mask",style:{zIndex:e.len&&t.$index===e.len?1:-1}})]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"6",label:"Total Price(incl. VAT)"}})],1)],1)])},staticRenderFns:[]};var l=a("VU/8")(o,i,!1,function(e){a("lu5b"),a("hRe6")},"data-v-90e2cdee",null);t.default=l.exports}});
//# sourceMappingURL=30.dc95a200a4c8af374ebb.js.map