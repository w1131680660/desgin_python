webpackJsonp([79],{QmBg:function(t,e){},dh0N:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var l=a("BO1k"),n=a.n(l),i=a("lHA8"),r=a.n(i),o=a("Gu7T"),s=a.n(o),c={name:"",props:{},components:{},data:function(){return{menuPlatFormList:[],menuCountryList:[],menuSiteList:[],showCountryList:[],showSiteList:[],lastSiteList:[],checkedPlatform:"",checkedCountry:"",checkedSite:"",brandFileList:[],uploadBrandDialogVisible:!1,uploadBrandForm:{platform:"",country:"",site:"",store:"",name:""},fileData:[],file:"",platformList:["Amanzon"],countryList:[],siteList:[],storeList:[],formRules:{platform:[{required:!0,message:"请选择渠道",trigger:"change"}],site:[{required:!0,message:"请选择站点",trigger:"change"}],country:[{required:!0,message:"请选择国家",trigger:"change"}],store:[{required:!0,message:"请选择店铺",trigger:"change"}],name:[{required:!0,message:"请输入品牌",trigger:"blur"}]},currentPage:1,total:0,pageSize:50}},computed:{},watch:{},methods:{getMenuList:function(){var t=this;this.$api.getMenuList().then(function(e){t.menuPlatFormList=e.data.data1,t.menuCountryList=e.data.data2,t.menuSiteList=e.data.data3,t.showCountryList=t.menuCountryList[0],t.showSiteList=t.menuSiteList[0],t.lastSiteList=t.showSiteList[0],t.checkedPlatform=t.menuPlatFormList[0],t.checkedCountry=t.showCountryList[0],t.checkedSite=t.lastSiteList[0],t.thirdClick(t.checkedPlatform,t.checkedCountry,t.checkedSite)})},getCountryList:function(){var t=this;this.$api.getCountryList().then(function(e){console.log(e),t.countryList=e.data.data})},getSelectData:function(){var t=this;this.$api.getSelectData().then(function(e){t.storeList=e.data.store_list,t.storeList=[].concat(s()(new r.a(t.storeList)))})},onceClick:function(t){this.showCountryList=[],this.showSiteList=[],this.showCountryList=this.menuCountryList[t],this.showSiteList=this.menuSiteList[t]},secondClick:function(t){this.lastSiteList=[],this.lastSiteList=this.showSiteList[t]},thirdClick:function(t,e,a){var l=this;this.checkedPlatform=t,this.checkedCountry=e,this.checkedSite=a;this.$api.queryBrand(t,e,a,1).then(function(t){console.log(t),l.brandFileList=t.data.data,l.total=t.data.all_number,l.$nextTick(function(){l.$refs.bmTable.bodyWrapper.scrollTop=0})})},uploadClick:function(){this.getCountryList(),this.getSelectData(),this.uploadBrandDialogVisible=!0},uploadBrandConfirm:function(){var t=this;this.$refs.uploadBrandRef.validate(function(e){if(e){if(0==t.fileData.length)return t.$message.closeAll(),t.$message.error("请上传至少一个文件");var a=new FormData;a.append("brand_platform",t.uploadBrandForm.platform),a.append("brand_country",t.uploadBrandForm.country),a.append("brand_site",t.uploadBrandForm.site),a.append("brand_store",t.uploadBrandForm.store),a.append("brand_name",t.uploadBrandForm.name);var l=!0,i=!1,r=void 0;try{for(var o,s=n()(t.fileData);!(l=(o=s.next()).done);l=!0){var c=o.value;a.append("file",c)}}catch(t){i=!0,r=t}finally{try{!l&&s.return&&s.return()}finally{if(i)throw r}}t.$api.uploadBrand(a).then(function(e){t.$message.success("上传成功"),t.thirdClick(t.checkedPlatform,t.checkedCountry,t.checkedSite),t.uploadBrandDialogVisible=!1})}})},uploadBrandDialogClose:function(){this.$refs.uploadBrandRef.resetFields(),this.$refs.upload.clearFiles()},selectChange:function(t){var e=this;console.log(t),this.$api.getSiteList(t).then(function(t){console.log(t),e.siteList=t.data.data})},beforeUpload:function(t){this.fileData.push(t),this.file=t},uploadFile:function(t){},handleRemove:function(t){for(var e in this.fileData)this.fileData[e]===t.raw&&this.fileData.splice(e,1)},handleCurrentChange:function(t){var e=this;console.log(t),this.$api.queryBrand(this.checkedPlatform,this.checkedCountry,this.checkedSite,t).then(function(t){e.brandFileList=t.data.data,e.$nextTick(function(){e.$refs.bmTable.bodyWrapper.scrollTop=0})})}},created:function(){this.getMenuList()},mounted:function(){}},u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"ipi-board"}},[a("div",{staticClass:"left"},[t._m(0),t._v(" "),a("div",{staticClass:"left-content"},[a("h4",[t._v("请选择店铺")]),t._v(" "),a("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{"default-active":"0-0-0","unique-opened":""}},t._l(t.menuPlatFormList,function(e,l){return a("el-submenu",{key:l,attrs:{index:l+""}},[a("template",{slot:"title"},[a("span",{staticStyle:{display:"inline-block",width:"100%"},on:{click:function(e){return t.onceClick(l)}}},[t._v(t._s(e))])]),t._v(" "),t._l(t.showCountryList,function(n,i){return a("el-submenu",{key:i,attrs:{index:l+"-"+i}},[a("template",{slot:"title"},[a("span",{staticStyle:{display:"inline-block",width:"100%"},on:{click:function(e){return t.secondClick(i)}}},[t._v(t._s(n))])]),t._v(" "),t._l(t.lastSiteList,function(r,o){return a("el-menu-item",{key:o,attrs:{index:l+"-"+i+"-"+o},on:{click:function(a){return t.thirdClick(e,n,r)}}},[a("span",[t._v(t._s(r))])])})],2)})],2)}),1)],1)]),t._v(" "),a("div",{staticClass:"right"},[a("div",{staticClass:"upload"},[a("span",{staticStyle:{"margin-right":"20px"}},[t._v("点击上传品牌备案文件")]),t._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.uploadClick}},[t._v("上传")])],1),t._v(" "),a("div",{staticClass:"table"},[a("el-table",{ref:"bmTable",staticStyle:{width:"100%"},attrs:{data:t.brandFileList,border:"","max-height":"700"}},[a("el-table-column",{attrs:{type:"index",label:"序号",width:"70"}}),t._v(" "),a("el-table-column",{attrs:{prop:"1",label:"渠道",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"2",label:"店铺",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"3",label:"站点",width:"70",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"4",label:"国家",width:"70",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"5",label:"品牌",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"6",label:"品牌备案文件",width:"300",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("a",{attrs:{href:t._urlzgl+e.row[6],target:"_blank"}},[t._v(t._s(e.row[6].slice(e.row[6].lastIndexOf("/")+1)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"7",label:"备案人",width:"100",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"8",align:"center",label:"备案时间"}})],1),t._v(" "),a("el-pagination",{staticStyle:{"text-align":"center","margin-top":"10px"},attrs:{"current-page":t.currentPage,"page-size":t.pageSize,layout:"total,prev, pager, next, jumper",total:t.total},on:{"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e}}})],1)]),t._v(" "),a("el-dialog",{staticClass:"upload-dialog",attrs:{visible:t.uploadBrandDialogVisible,width:"30%",center:"","close-on-click-modal":!1,"close-on-press-escape":!1,title:"备案文件上传"},on:{"update:visible":function(e){t.uploadBrandDialogVisible=e},close:t.uploadBrandDialogClose}},[a("el-form",{ref:"uploadBrandRef",attrs:{model:t.uploadBrandForm,rules:t.formRules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"渠道",prop:"platform"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.uploadBrandForm.platform,callback:function(e){t.$set(t.uploadBrandForm,"platform",e)},expression:"uploadBrandForm.platform"}},t._l(t.platformList,function(t,e){return a("el-option",{key:e,attrs:{label:t,value:t}})}),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"国家",prop:"country"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:t.selectChange},model:{value:t.uploadBrandForm.country,callback:function(e){t.$set(t.uploadBrandForm,"country",e)},expression:"uploadBrandForm.country"}},t._l(t.countryList,function(t,e){return a("el-option",{key:e,attrs:{label:t,value:t}})}),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"站点",prop:"site"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.uploadBrandForm.site,callback:function(e){t.$set(t.uploadBrandForm,"site",e)},expression:"uploadBrandForm.site"}},t._l(t.siteList,function(t,e){return a("el-option",{key:e,attrs:{label:t,value:t}})}),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"店铺",prop:"store"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.uploadBrandForm.store,callback:function(e){t.$set(t.uploadBrandForm,"store",e)},expression:"uploadBrandForm.store"}},t._l(t.storeList,function(t,e){return a("el-option",{key:e,attrs:{label:t,value:t}})}),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"品牌",prop:"name"}},[a("el-input",{model:{value:t.uploadBrandForm.name,callback:function(e){t.$set(t.uploadBrandForm,"name",e)},expression:"uploadBrandForm.name"}})],1),t._v(" "),a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{drag:"",action:"123",multiple:"","before-upload":t.beforeUpload,"http-request":t.uploadFile,"on-remove":t.handleRemove}},[a("i",{staticClass:"el-icon-upload"}),t._v(" "),a("div",{staticClass:"el-upload__text"},[t._v("\n          将文件拖到此处，或\n          "),a("em",[t._v("点击上传")])])])],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.uploadBrandDialogVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.uploadBrandConfirm}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"title"},[e("h3",{staticStyle:{"text-align":"center"}},[this._v("品牌维护-备案文档管理")])])}]};var d=a("VU/8")(c,u,!1,function(t){a("QmBg")},"data-v-79a9bec7",null);e.default=d.exports}});
//# sourceMappingURL=79.12882b8a879b3492e4f3.js.map